
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Wyre API Documentation</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
      <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet">
  </head>

  <body class="index" data-languages="[&quot;cURL&quot;,&quot;ruby&quot;,&quot;python&quot;,&quot;java&quot;,&quot;php&quot;,&quot;json&quot;,&quot;csharp&quot;]">
    <div class="mobile-nav">
        <a href="#" id="nav-button">
            <span>
                <!--NAV-->
                <img src="images/navbar.png" alt="Navbar" />
            </span>
        </a>
    </div>
    <div class="toc-wrapper">
      <img src="images/WyreDocsLogo.svg" class="logo" alt="Wyredocslogo" />
        <div class="lang-selector">
              <a href="#" data-language-name="cURL">cURL</a>
              <a href="#" data-language-name="ruby">ruby</a>
              <a href="#" data-language-name="python">python</a>
              <a href="#" data-language-name="java">java</a>
              <a href="#" data-language-name="php">php</a>
              <a href="#" data-language-name="json">json</a>
              <a href="#" data-language-name="csharp">csharp</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#overview" class="toc-h1 toc-link" data-title="overview">Overview</a>
          </li>
          <li>
            <a href="#getting-started" class="toc-h1 toc-link" data-title="getting-started">Getting Started</a>
          </li>
          <li>
            <a href="#general" class="toc-h1 toc-link" data-title="general">General</a>
              <ul class="toc-list-h2">
                  <li>
                    
                    <a href="#supported-countries" class="toc-h2 toc-link" data-title="supported-countries">Supported Countries</a>
                  </li>
                  <li>
                    
                    <a href="#transport-method" class="toc-h2 toc-link" data-title="transport-method">Transport Method</a>
                  </li>
                  <li>
                    
                    <a href="#production-test-endpoints" class="toc-h2 toc-link" data-title="production-test-endpoints">Production/Test Endpoints</a>
                  </li>
                  <li>
                    
                    <a href="#pagination" class="toc-h2 toc-link" data-title="pagination">Pagination</a>
                  </li>
                  <li>
                    
                    <a href="#authentication" class="toc-h2 toc-link" data-title="authentication">Authentication</a>
                  </li>
                  <li>
                    
                    <a href="#srns" class="toc-h2 toc-link" data-title="srns">SRNs</a>
                  </li>
                  <li>
                    
                    <a href="#fees" class="toc-h2 toc-link" data-title="fees">Fees</a>
                  </li>
                  <li>
                    
                    <a href="#error-table" class="toc-h2 toc-link" data-title="error-table">Error Table</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#step-by-step-guide" class="toc-h1 toc-link" data-title="step-by-step-guide">Step-by-step Guide</a>
              <ul class="toc-list-h2">
                  <li>
                    
                    <a href="#virtual-banking" class="toc-h2 toc-link" data-title="virtual-banking">Virtual Banking</a>
                  </li>
  <ul class="toc-list-h3">
      <li>
        <a href="#step-1-create-a-wallet-with-kyc-data" class="toc-h3 toc-link" data-title="Step-by-step Guide">Step 1. Create a Wallet with KYC Data</a>
      </li>
      <li>
        <a href="#step-2-upload-kyc-documents" class="toc-h3 toc-link" data-title="Step-by-step Guide">Step 2. Upload KYC documents</a>
      </li>
      <li>
        <a href="#step-3-update-kyc-data-to-include-documents" class="toc-h3 toc-link" data-title="Step-by-step Guide">Step 3. Update KYC Data to include documents</a>
      </li>
      <li>
        <a href="#step-4-check-for-banking-data" class="toc-h3 toc-link" data-title="Step-by-step Guide">Step 4. Check for banking data</a>
      </li>
      <li>
        <a href="#step-5-receiving-funds-and-callbacks" class="toc-h3 toc-link" data-title="Step-by-step Guide">Step 5. Receiving Funds and Callbacks</a>
      </li>
      <li>
        <a href="#step-6-transfer-usd-from-wallet-to-account" class="toc-h3 toc-link" data-title="Step-by-step Guide">Step 6. Transfer USD from wallet to Account</a>
      </li>
      <li>
        <a href="#step-7-the-user-wants-to-cash-out-their-remaining-usd" class="toc-h3 toc-link" data-title="Step-by-step Guide">Step 7. The user wants to cash out their remaining USD</a>
      </li>
  </ul>
              </ul>
          </li>
          <li>
            <a href="#account" class="toc-h1 toc-link" data-title="account">Account</a>
              <ul class="toc-list-h2">
                  <li>
                    
                    <a href="#account-details" class="toc-h2 toc-link" data-title="account-details">Account Details</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#wallets" class="toc-h1 toc-link" data-title="wallets">Wallets</a>
              <ul class="toc-list-h2">
                  <li>
                    
                    <a href="#create-wallet" class="toc-h2 toc-link" data-title="create-wallet">Create Wallet</a>
                  </li>
                  <li>
                    
                    <a href="#create-mulitple-wallets" class="toc-h2 toc-link" data-title="create-mulitple-wallets">Create Mulitple Wallets</a>
                  </li>
                  <li>
                    
                    <a href="#lookup-wallet" class="toc-h2 toc-link" data-title="lookup-wallet">Lookup Wallet</a>
                  </li>
                  <li>
                    
                    <a href="#edit-wallet" class="toc-h2 toc-link" data-title="edit-wallet">Edit Wallet</a>
                  </li>
                  <li>
                    
                    <a href="#delete-wallet" class="toc-h2 toc-link" data-title="delete-wallet">Delete Wallet</a>
                  </li>
                  <li>
                    
                    <a href="#list-wallets" class="toc-h2 toc-link" data-title="list-wallets">List Wallets</a>
                  </li>
                  <li>
                    
                    <a href="#callbacks" class="toc-h2 toc-link" data-title="callbacks">Callbacks</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#transfers" class="toc-h1 toc-link" data-title="transfers">Transfers</a>
              <ul class="toc-list-h2">
                  <li>
                    
                    <a href="#introduction" class="toc-h2 toc-link" data-title="introduction">Introduction</a>
                  </li>
                  <li>
                    
                    <a href="#transfers-2" class="toc-h2 toc-link" data-title="transfers">Transfers</a>
                  </li>
                  <li>
                    
                    <a href="#create-transfer" class="toc-h2 toc-link" data-title="create-transfer">Create Transfer</a>
                  </li>
                  <li>
                    
                    <a href="#confirm-transfer" class="toc-h2 toc-link" data-title="confirm-transfer">Confirm Transfer</a>
                  </li>
                  <li>
                    
                    <a href="#lookup-transfer" class="toc-h2 toc-link" data-title="lookup-transfer">Lookup Transfer</a>
                  </li>
                  <li>
                    
                    <a href="#transfer-status" class="toc-h2 toc-link" data-title="transfer-status">Transfer Status</a>
                  </li>
                  <li>
                    
                    <a href="#callbacks-2" class="toc-h2 toc-link" data-title="callbacks">Callbacks</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#payment-methods" class="toc-h1 toc-link" data-title="payment-methods">Payment Methods</a>
              <ul class="toc-list-h2">
                  <li>
                    
                    <a href="#create-payment-method" class="toc-h2 toc-link" data-title="create-payment-method">Create Payment Method</a>
                  </li>
                  <li>
                    
                    <a href="#lookup-payment-method" class="toc-h2 toc-link" data-title="lookup-payment-method">Lookup Payment Method</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#country-currency-requirements" class="toc-h1 toc-link" data-title="country-currency-requirements">Country/Currency Requirements</a>
              <ul class="toc-list-h2">
                  <li>
                    
                    <a href="#china" class="toc-h2 toc-link" data-title="china">China</a>
                  </li>
                  <li>
                    
                    <a href="#usa" class="toc-h2 toc-link" data-title="usa">USA</a>
                  </li>
              </ul>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='https://www.epiapi.com'>Visit us!</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='overview'>Overview</h1>
<p>epiapi is focused on enterprise tools that improve accessibility and usability of financial services across borders. We offer a powerful REST API that supports virtual banking services for enterprises, through our parent company Wyre.</p>

<p>Our API uses HTTPS response codes and returns all error responses in JSON. To explore the API as much as possible, we offer a test environment in addition to production. Any transfers made in the test environment will not be executed. Both sandbox and production rely on API keys for authentication.</p>
<h1 id='getting-started'>Getting Started</h1>
<p>This guide is written as a standard implementation of our virtual banking service for setting up an environment to create US bank accounts for merchants selling on Amazon. Through this implementation you will be able to pass the necessary KYC information in order to open a virtual bank account, receive the bank account number, monitor for receivables, and manage funds for delivery to a designated bank account. All integrations will require a signed agreement with epiapi - please reach out to us at: contact@epiapi.com if you do not have an agreement in place or for any other questions.</p>

<p><strong>How to get Started</strong></p>

<p><strong>Step 1. Read the documentation</strong> <br>
You are already doing this. Congratulations! <br></p>

<p><strong>Step 2. Register a test account</strong> <br>
Sign up <a href="https://www.testwyre.com">here</a> to interact with our test environment. No need to upload any documents for the test envornment (though this will be required on production) - jump straight to Step 3. <br></p>

<p><strong>Step 3. Verify your test account</strong> <br>
Contact our support team at <a href="mailto:support@epiapi.com">support@epiapi.com</a> so we can verify your test account and add test funds that you can start using. The test API does not execute real transactions so feel free to go crazy. <br></p>

<p><strong>Step 4. Get Support</strong><br>
We will send you links to join us on Slack or other chat apps (DingTalk, QQ etc) - any questions just ask! <br></p>

<p><strong>Step 5. Register a production account</strong> <br>
Once testing has completed, you can register a live account <a href="https://testwyre.com">here</a>. You must go through the entire onboarding and verification process before you are allowed to interact with the account. <br></p>

<p><strong>Step 6. Go live!</strong><br>
Once fully onboarded you are ready to go!</p>
<h1 id='general'>General</h1><h2 id='supported-countries'>Supported Countries</h2>
<p>Our Virtual banking product currently accepts USD via ACH to a domestic US bank account. <br></p>

<p><strong>Countries</strong> <br>
- United States
- European Union (coming soon)
- Australia (coming soon)</p>

<p><p>We are adding more countries soon. We will send an email as and when we release new funcionality ;)</p>

<p><strong>Currencies</strong> <br>
- USD
- EUR (coming soon)
- GBP (coming soon)
- AUD (coming soon)</p>
<h2 id='transport-method'>Transport Method</h2>
<p>We provide a REST API that will always return a JSON Object as the response.<br></p>

<p>During troubleshooting, please note that if your error response does not follow the previously mentioned format, the error is most likely due to a different endpoint.</p>
<pre class="highlight json tab-json"><code><span class="err">For</span><span class="w"> </span><span class="err">successful</span><span class="w"> </span><span class="err">API</span><span class="w"> </span><span class="err">calls</span><span class="p">:</span><span class="w">

</span><span class="p">{</span><span class="w">
        </span><span class="s2">"parameter"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="err">&lt;br&gt;</span><span class="w">
        </span><span class="s2">"parameter"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ABCDEF"</span><span class="w"> </span><span class="err">&lt;br&gt;</span><span class="w">

</span><span class="p">}</span><span class="w">

</span><span class="err">For</span><span class="w"> </span><span class="err">unsuccessful</span><span class="w"> </span><span class="err">API</span><span class="w"> </span><span class="err">calls</span><span class="p">:</span><span class="w">

</span><span class="p">{</span><span class="w">
        </span><span class="s2">"language"</span><span class="p">:</span><span class="s2">"en"</span><span class="p">,</span><span class="err">&lt;br&gt;</span><span class="w">
        </span><span class="s2">"exceptionId"</span><span class="p">:</span><span class="s2">"ABCDEF"</span><span class="p">,</span><span class="err">&lt;br&gt;</span><span class="w">
        </span><span class="s2">"compositeType"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="err">&lt;br&gt;</span><span class="w">
        </span><span class="s2">"subType"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="err">&lt;br&gt;</span><span class="w">
        </span><span class="s2">"message"</span><span class="p">:</span><span class="s2">"Error Message"</span><span class="p">,</span><span class="err">&lt;br&gt;</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"ErrorTypeException"</span><span class="p">,</span><span class="err">&lt;br&gt;</span><span class="w">
        </span><span class="s2">"transient"</span><span class="p">:</span><span class="kc">false</span><span class="w"> </span><span class="err">&lt;br&gt;</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h2 id='production-test-endpoints'>Production/Test Endpoints</h2>
<p>We have two environments, <code>testwyre</code> for API integration testing and <code>testwyre</code>, our production environment.</p>

<table><thead>
<tr>
<th>Environment</th>
<th>Endpoint</th>
</tr>
</thead><tbody>
<tr>
<td>Test</td>
<td><a href="https://api.testwyre.com"> https://api.testwyre.com </a></td>
</tr>
<tr>
<td>Production</td>
<td><a href="https://api.sendwyre.com"> https://api.sendwyre.com </a></td>
</tr>
</tbody></table>
<h2 id='pagination'>Pagination</h2>
<p>We split our tabular data into pages of 25 items. You can apply the parameters below to any request to adjust the pagination.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>offset</td>
<td>How many items are skipped before the first item that is shown (default: 0).</td>
</tr>
<tr>
<td>limit</td>
<td>Number of items returned per page (default: 25).</td>
</tr>
<tr>
<td>from</td>
<td>The lower bound of a creation time filter for the displayed items. Formatted in millisecond Epoch format. (default: 0)</td>
</tr>
<tr>
<td>to</td>
<td>The upper bound of a creation time filter for the displayed items. Formatted in millisecond Epoch format. (default: current time)</td>
</tr>
</tbody></table>
<h2 id='authentication'>Authentication</h2><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'uri'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'digest/hmac'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="k">class</span> <span class="nc">WyreApi</span>
  <span class="nc">ACCOUNT_ID</span> <span class="o">=</span> <span class="s1">'YOUR_ACCOUNT_ID_HERE'</span>
  <span class="no">API_KEY</span> <span class="o">=</span> <span class="s1">'YOUR_API_KEY_HERE'</span>
  <span class="no">SEC_KEY</span> <span class="o">=</span> <span class="s1">'YOUR_SECRET_KEY_HERE'</span>
  <span class="no">API_URL</span> <span class="o">=</span> <span class="s1">'https://api.testwyre.com'</span>

  <span class="k">def</span> <span class="nf">create_transfer</span> <span class="n">options</span>
    <span class="n">api_post</span> <span class="s1">'/transfers'</span><span class="p">,</span> <span class="n">options</span>
  <span class="k">end</span>

  <span class="kp">private</span>

  <span class="k">def</span> <span class="nf">api_post</span> <span class="n">path</span><span class="p">,</span> <span class="n">post_data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s1">'timestamp'</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="no">Time</span><span class="p">.</span><span class="nf">now</span><span class="p">.</span><span class="nf">to_i</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">).</span><span class="nf">to_s</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="no">API_URL</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="s1">'?'</span> <span class="o">+</span> <span class="no">URI</span><span class="p">.</span><span class="nf">encode_www_form</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s1">'X-Api-Key'</span> <span class="o">=&gt;</span> <span class="no">API_KEY</span><span class="p">,</span>
      <span class="s1">'X-Api-Signature'</span> <span class="o">=&gt;</span> <span class="n">calc_auth_sig_hash</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">post_data</span><span class="p">.</span><span class="nf">to_json</span><span class="p">.</span><span class="nf">to_s</span><span class="p">),</span>
      <span class="s1">'X-Api-Version'</span> <span class="o">=&gt;</span> <span class="s1">'2'</span>
    <span class="p">}</span>

    <span class="n">uri</span> <span class="o">=</span> <span class="no">URI</span> <span class="no">API_URL</span>
    <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">start</span><span class="p">(</span><span class="n">uri</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">uri</span><span class="p">.</span><span class="nf">port</span><span class="p">,</span> <span class="ss">:use_ssl</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">http</span><span class="o">|</span>
      <span class="n">http</span><span class="p">.</span><span class="nf">request_post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">post_data</span><span class="p">.</span><span class="nf">to_json</span><span class="p">.</span><span class="nf">to_s</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">res</span><span class="o">|</span>
        <span class="n">response</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span> <span class="n">res</span><span class="p">.</span><span class="nf">body</span>
        <span class="k">raise</span> <span class="n">response</span><span class="p">[</span><span class="s1">'message'</span><span class="p">]</span> <span class="k">if</span> <span class="n">res</span><span class="p">.</span><span class="nf">code</span> <span class="o">!=</span> <span class="s1">'200'</span>
        <span class="k">return</span> <span class="n">response</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">calc_auth_sig_hash</span> <span class="n">url_body</span>
    <span class="k">return</span> <span class="no">Digest</span><span class="o">::</span><span class="no">HMAC</span><span class="p">.</span><span class="nf">hexdigest</span> <span class="n">url_body</span><span class="p">,</span> <span class="no">SEC_KEY</span><span class="p">,</span> <span class="no">Digest</span><span class="o">::</span><span class="no">SHA256</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">api</span> <span class="o">=</span> <span class="no">WyreApi</span><span class="p">.</span><span class="nf">new</span>
<span class="n">api</span><span class="p">.</span><span class="nf">create_transfer</span><span class="p">({</span><span class="s1">'sourceAmount'</span><span class="o">=&gt;</span><span class="mi">50</span><span class="p">,</span><span class="s1">'sourceCurrency'</span><span class="o">=&gt;</span><span class="s1">'USD'</span><span class="p">,</span><span class="s1">'dest'</span><span class="o">=&gt;</span><span class="s1">'richard@epiapi.com'</span><span class="p">,</span> <span class="s1">'destCurrency'</span><span class="o">=&gt;</span><span class="s1">'CNY'</span><span class="p">,</span> <span class="s1">'message'</span><span class="o">=&gt;</span><span class="s1">'buy Richard pizza'</span><span class="p">)</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c">#dependencies:</span>
<span class="c">#python3</span>
<span class="c">#pip3 install requests</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">requests</span> <span class="kn">import</span> <span class="n">request</span>

<span class="k">class</span> <span class="nc">MassPay_API</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_id</span><span class="p">,</span> <span class="n">api_version</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">api_secret</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">account_id</span> <span class="o">=</span> <span class="n">account_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_url</span> <span class="o">=</span> <span class="s">'https://api.testwyre.com/{}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">api_version</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_version</span> <span class="o">=</span> <span class="n">api_version</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="n">api_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_secret</span> <span class="o">=</span> <span class="n">api_secret</span>

    <span class="c">#authentication decorator. May raise ValueError if no json content is returned</span>
    <span class="k">def</span> <span class="nf">authenticate_request</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">wrap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">url</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">body</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
            <span class="n">url</span> <span class="o">+=</span> <span class="s">'?timestamp={}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
            <span class="n">bodyJson</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span> <span class="k">if</span> <span class="n">body</span> <span class="o">!=</span> <span class="s">''</span> <span class="k">else</span> <span class="s">''</span>
            <span class="n">headers</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">headers</span><span class="p">[</span><span class="s">'Content-Type'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'application/json'</span>
            <span class="n">headers</span><span class="p">[</span><span class="s">'X-Api-Version'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_version</span>
            <span class="n">headers</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span>
            <span class="n">headers</span><span class="p">[</span><span class="s">'X-Api-Signature'</span><span class="p">]</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">api_secret</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">),</span> <span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">bodyJson</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">),</span> <span class="s">'SHA256'</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
            <span class="k">print</span><span class="p">(</span><span class="n">headers</span><span class="p">[</span><span class="s">'X-Api-Signature'</span><span class="p">])</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span> <span class="k">if</span> <span class="n">body</span> <span class="o">!=</span> <span class="s">''</span> <span class="k">else</span> <span class="bp">None</span><span class="p">),</span> <span class="n">json</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span> <span class="c">#Wyre will always try to give an err body</span>
                <span class="k">return</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="k">return</span> <span class="mi">404</span><span class="p">,</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="n">wrap</span>

    <span class="nd">@authenticate_request</span>
    <span class="k">def</span> <span class="nf">retrieve_exchange_rates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_url</span> <span class="o">+</span> <span class="s">'/rates'</span>
        <span class="n">method</span> <span class="o">=</span> <span class="s">'GET'</span>
        <span class="n">body</span> <span class="o">=</span> <span class="s">''</span>
        <span class="k">return</span> <span class="n">url</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">body</span>

    <span class="nd">@authenticate_request</span>
    <span class="k">def</span> <span class="nf">retrieve_account</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_url</span> <span class="o">+</span> <span class="s">'/account'</span>
        <span class="n">method</span> <span class="o">=</span> <span class="s">'GET'</span>
        <span class="n">body</span> <span class="o">=</span> <span class="s">''</span>
        <span class="k">return</span> <span class="n">url</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">body</span>

    <span class="nd">@authenticate_request</span>
    <span class="k">def</span> <span class="nf">create_transfer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sourceAmount</span><span class="p">,</span> <span class="n">sourceCurrency</span><span class="p">,</span> <span class="n">destAmount</span><span class="p">,</span> <span class="n">destCurrency</span><span class="p">,</span> <span class="n">destAddress</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">autoConfirm</span><span class="p">):</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_url</span> <span class="o">+</span> <span class="s">'/transfers'</span>
        <span class="n">method</span> <span class="o">=</span> <span class="s">'POST'</span>
        <span class="c">#ONLY use either sourceAmount or destAmount, see documentation</span>
        <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s">'sourceCurrency'</span><span class="p">:</span><span class="n">sourceCurrency</span><span class="p">,</span>
                <span class="s">'dest'</span><span class="p">:</span><span class="n">destAddress</span><span class="p">,</span>
                <span class="s">'destCurrency'</span><span class="p">:</span><span class="n">destCurrency</span><span class="p">,</span>
                <span class="s">'message'</span><span class="p">:</span><span class="n">message</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">sourceAmount</span><span class="p">:</span>
            <span class="n">body</span><span class="p">[</span><span class="s">"sourceAmount"</span><span class="p">]</span> <span class="o">=</span> <span class="n">sourceAmount</span>
        <span class="k">elif</span> <span class="n">destAmount</span><span class="p">:</span>
            <span class="n">body</span><span class="p">[</span><span class="s">"destAmount"</span><span class="p">]</span> <span class="o">=</span> <span class="n">destAmount</span>
        <span class="k">if</span> <span class="n">autoConfirm</span><span class="p">:</span>
            <span class="n">body</span><span class="p">[</span><span class="s">'autoConfirm'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="n">url</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">body</span>

    <span class="nd">@authenticate_request</span>
    <span class="k">def</span> <span class="nf">confirm_transfer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transfer_id</span><span class="p">):</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_url</span> <span class="o">+</span> <span class="s">'/transfer/{}/confirm'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">transfer_id</span><span class="p">)</span>
        <span class="n">method</span> <span class="o">=</span> <span class="s">'POST'</span>
        <span class="n">body</span> <span class="o">=</span> <span class="s">''</span>
        <span class="k">return</span> <span class="n">url</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">body</span>  

    <span class="nd">@authenticate_request</span>
    <span class="k">def</span> <span class="nf">status_transfer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transfer_id</span><span class="p">):</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_url</span> <span class="o">+</span> <span class="s">'/transfer/{}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">transfer_id</span><span class="p">)</span>
        <span class="n">method</span> <span class="o">=</span> <span class="s">'GET'</span>
        <span class="n">body</span> <span class="o">=</span> <span class="s">''</span>
        <span class="k">return</span> <span class="n">url</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">body</span>  

<span class="c">#USAGE Example</span>
<span class="n">account_id</span> <span class="o">=</span> <span class="s">"YOUR_ACCOUNT_ID_HERE"</span> <span class="c">#optional</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"YOUR_API_KEY_HERE"</span>
<span class="n">secret_key</span> <span class="o">=</span> <span class="s">"YOUR_SECRET_KEY_HERE"</span>
<span class="n">api_version</span> <span class="o">=</span> <span class="s">"2"</span>

<span class="c">#create Wyre MassPay API object</span>
<span class="n">Wyre</span> <span class="o">=</span> <span class="n">MassPay_API</span><span class="p">(</span><span class="n">account_id</span><span class="p">,</span> <span class="n">api_version</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">)</span>

<span class="c">#get account info</span>
<span class="n">http_code</span><span class="p">,</span> <span class="n">account</span> <span class="o">=</span> <span class="n">Wyre</span><span class="o">.</span><span class="n">retrieve_account</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">account</span><span class="p">)</span>
</code></pre><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">javax.crypto.Mac</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.SecretKeySpec</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.BufferedReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.DataOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStreamReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.Integer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.String</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.StringBuffer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.HttpURLConnection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URL</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestAuth</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">apiKey</span> <span class="o">=</span> <span class="s">"YOUR_API_KEY_HERE"</span><span class="o">;</span>
    <span class="n">String</span> <span class="n">secretKey</span> <span class="o">=</span> <span class="s">"YOUR_SECRET_KEY_HERE"</span><span class="o">;</span>

    <span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.testwyre.com/account"</span><span class="o">;</span>
    <span class="n">String</span> <span class="n">method</span> <span class="o">=</span> <span class="s">"GET"</span><span class="o">;</span>
    <span class="n">String</span> <span class="n">data</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>

    <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">executeWyreRequest</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="s">""</span><span class="o">,</span> <span class="n">method</span><span class="o">,</span> <span class="n">apiKey</span><span class="o">,</span> <span class="n">secretKey</span><span class="o">);</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.testwyre.com/transfers"</span><span class="o">;</span>
    <span class="n">method</span> <span class="o">=</span> <span class="s">"POST"</span><span class="o">;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="s">"{"</span> <span class="o">+</span>
        <span class="s">"  \"dest\": \"sam@testwyre.com\","</span> <span class="o">+</span>
        <span class="s">"  \"destCurrency\": \"USD\","</span> <span class="o">+</span>
        <span class="s">"  \"sourceCurrency\" : \"BTC\","</span> <span class="o">+</span>
        <span class="s">"  \"sourceAmount\" : \"1\","</span> <span class="o">+</span>
        <span class="s">"  \"message\": \"$1 worth of bitcoin!\""</span> <span class="o">+</span>
        <span class="s">"}"</span><span class="o">;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">executeWyreRequest</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="n">data</span><span class="o">,</span> <span class="n">method</span><span class="o">,</span> <span class="n">apiKey</span><span class="o">,</span> <span class="n">secretKey</span><span class="o">);</span>

    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">executeWyreRequest</span><span class="o">(</span><span class="n">String</span> <span class="n">targetURL</span><span class="o">,</span> <span class="n">String</span> <span class="n">requestBody</span><span class="o">,</span> <span class="n">String</span> <span class="n">method</span><span class="o">,</span> <span class="n">String</span> <span class="n">apiKey</span><span class="o">,</span> <span class="n">String</span> <span class="n">secretKey</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">URL</span> <span class="n">url</span><span class="o">;</span>
    <span class="n">HttpURLConnection</span> <span class="n">connection</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">{</span>

      <span class="n">targetURL</span> <span class="o">+=</span> <span class="o">((</span><span class="n">targetURL</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="s">"?"</span><span class="o">)&gt;</span><span class="mi">0</span><span class="o">)?</span><span class="s">"&amp;"</span><span class="o">:</span><span class="s">"?"</span><span class="o">)</span> <span class="o">+</span> <span class="s">"timestamp="</span> <span class="o">+</span> <span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>

      <span class="c1">//Create connection</span>
      <span class="n">url</span> <span class="o">=</span> <span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="n">targetURL</span><span class="o">);</span>
      <span class="n">connection</span> <span class="o">=</span> <span class="o">(</span><span class="n">HttpURLConnection</span><span class="o">)</span><span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
      <span class="n">connection</span><span class="o">.</span><span class="na">setRequestMethod</span><span class="o">(</span><span class="n">method</span><span class="o">);</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">connection</span><span class="o">.</span><span class="na">getRequestMethod</span><span class="o">());</span>

      <span class="n">connection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">);</span>
      <span class="n">connection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"Content-Length"</span><span class="o">,</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">requestBody</span><span class="o">.</span><span class="na">getBytes</span><span class="o">().</span><span class="na">length</span><span class="o">));</span>

      <span class="c1">//Specify API v2</span>
      <span class="n">connection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"X-Api-Version"</span><span class="o">,</span><span class="s">"2"</span><span class="o">);</span>

      <span class="c1">// Provide API key and signature</span>
      <span class="n">connection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"X-Api-Key"</span><span class="o">,</span> <span class="n">apiKey</span><span class="o">);</span>
      <span class="n">connection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"X-Api-Signature"</span><span class="o">,</span><span class="n">computeSignature</span><span class="o">(</span><span class="n">secretKey</span><span class="o">,</span><span class="n">targetURL</span><span class="o">,</span><span class="n">requestBody</span><span class="o">));</span>

      <span class="c1">//Send request</span>
      <span class="k">if</span><span class="o">(</span><span class="n">method</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"POST"</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">connection</span><span class="o">.</span><span class="na">setDoOutput</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
        <span class="n">connection</span><span class="o">.</span><span class="na">setRequestMethod</span><span class="o">(</span><span class="n">method</span><span class="o">);</span>

        <span class="n">DataOutputStream</span> <span class="n">wr</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DataOutputStream</span><span class="o">(</span>
            <span class="n">connection</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">());</span>

        <span class="n">wr</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">requestBody</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="s">"UTF-8"</span><span class="o">));</span>
        <span class="n">wr</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
        <span class="n">wr</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
      <span class="o">}</span>

      <span class="c1">//Get Response</span>
      <span class="n">InputStream</span> <span class="n">is</span><span class="o">;</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">connection</span><span class="o">.</span><span class="na">getResponseCode</span><span class="o">()</span> <span class="o">&lt;</span> <span class="n">HttpURLConnection</span><span class="o">.</span><span class="na">HTTP_BAD_REQUEST</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">is</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span>
      <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>

        <span class="n">is</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">getErrorStream</span><span class="o">();</span>
      <span class="o">}</span>

      <span class="n">BufferedReader</span> <span class="n">rd</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">InputStreamReader</span><span class="o">(</span><span class="n">is</span><span class="o">));</span>
      <span class="n">String</span> <span class="n">line</span><span class="o">;</span>
      <span class="n">StringBuffer</span> <span class="n">response</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="o">();</span>
      <span class="k">while</span><span class="o">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">response</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">line</span><span class="o">);</span>
        <span class="n">response</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="sc">'\r'</span><span class="o">);</span>
      <span class="o">}</span>
      <span class="n">rd</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
      <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>

    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>

      <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
      <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>

    <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>

      <span class="k">if</span><span class="o">(</span><span class="n">connection</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">connection</span><span class="o">.</span><span class="na">disconnect</span><span class="o">();</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">computeSignature</span><span class="o">(</span><span class="n">String</span> <span class="n">secretKey</span><span class="o">,</span> <span class="n">String</span> <span class="n">url</span><span class="o">,</span> <span class="n">String</span> <span class="n">reqData</span><span class="o">)</span> <span class="o">{</span>

    <span class="n">String</span> <span class="n">data</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="n">reqData</span><span class="o">;</span>

    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>

    <span class="k">try</span> <span class="o">{</span>
      <span class="n">Mac</span> <span class="n">sha256Hmac</span> <span class="o">=</span> <span class="n">Mac</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"HmacSHA256"</span><span class="o">);</span>
      <span class="n">SecretKeySpec</span> <span class="n">key</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecretKeySpec</span><span class="o">(</span><span class="n">secretKey</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(),</span> <span class="s">"HmacSHA256"</span><span class="o">);</span>
      <span class="n">sha256Hmac</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>

      <span class="kt">byte</span><span class="o">[]</span> <span class="n">macData</span> <span class="o">=</span> <span class="n">sha256Hmac</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="s">"UTF-8"</span><span class="o">));</span>

      <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
      <span class="k">for</span> <span class="o">(</span><span class="kd">final</span> <span class="kt">byte</span> <span class="n">element</span> <span class="o">:</span> <span class="n">macData</span><span class="o">){</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">((</span><span class="n">element</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="o">)</span> <span class="o">+</span> <span class="mh">0x100</span><span class="o">,</span> <span class="mi">16</span><span class="o">).</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
      <span class="o">}</span>
      <span class="k">return</span> <span class="n">result</span><span class="o">;</span>

    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
      <span class="k">return</span> <span class="s">""</span><span class="o">;</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre>
<!-- ```php
<?php
    function make_authenticated_request($endpoint, $method, $body) {
        $url = 'https://api.testwyre.com';
        $api_key = "YOUR_API_KEY_HERE";
        $secret_key = "YOUR_SECRET_KEY_HERE";

        $timestamp = floor(microtime(true)*1000);
        $request_url = $url . $endpoint;

        if(strpos($request_url,"?"))
            $request_url .= '&timestamp=' . $timestamp;
        else
            $request_url .= '?timestamp=' . $timestamp;

        if(!empty($body))
            $body = json_encode($body, JSON_FORCE_OBJECT);
        else
            $body = '';

        $headers = array(
            "Content-Type: application/json",
            "X-Api-Key: ". $api_key,
            "X-Api-Signature: ". calc_auth_sig_hash($secret_key, $request_url . $body),
            "X-Api-Version: 2"
        );
        $curl = curl_init();

        if($method=="POST"){
          $options = array(
            CURLOPT_URL             => $request_url,
            CURLOPT_POST            =>  true,
            CURLOPT_POSTFIELDS      => $body,
            CURLOPT_RETURNTRANSFER  => true);
        }else {
          $options = array(
            CURLOPT_URL             => $request_url,
            CURLOPT_RETURNTRANSFER  => true);
        }
        curl_setopt_array($curl, $options);
        curl_setopt($curl, CURLOPT_HTTPHEADER, $headers);
        $result = curl_exec($curl);
        curl_close($curl);
        var_dump($result);
        return json_decode($result, true);
    }

    function calc_auth_sig_hash($seckey, $val) {
        $hash = hash_hmac('sha256', $val, $seckey);
        return $hash;
    }

    echo make_authenticated_request("/account", "GET", array());
    $transfer = array(
      "sourceCurrency"=>"USD",
      "dest"=>"paymentmethod:PA-123123123",
      "sourceAmount"=> 100.01,
      "destCurrency"=>"USD",
      "amountIncludesFees"=>True
      "message"=> "Test"
      );
    echo make_authenticated_request("/transfers", "POST", $transfer);
    ?>
``` -->
<pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">namespace</span> <span class="nn">testauthwyre</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">MainClass</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">WyreApi</span> <span class="n">wyre</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WyreApi</span><span class="p">();</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">DateTimeOffset</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="nf">ToUnixTimeMilliseconds</span><span class="p">());</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">((</span><span class="kt">long</span><span class="p">)(</span><span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">DateTimeKind</span><span class="p">.</span><span class="n">Utc</span><span class="p">)).</span><span class="n">TotalMilliseconds</span><span class="p">);</span>
            <span class="n">HttpWebResponse</span> <span class="n">accountResponse</span> <span class="p">=</span> <span class="n">wyre</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">"/account"</span><span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="nf">GetResponseBody</span><span class="p">(</span><span class="n">accountResponse</span><span class="p">));</span>
            <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="n">body</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;();</span>
            <span class="n">body</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"sourceCurrency"</span><span class="p">,</span> <span class="s">"USD"</span><span class="p">);</span>
            <span class="n">body</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"sourceAmount"</span><span class="p">,</span> <span class="s">"10"</span><span class="p">);</span>
            <span class="n">body</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"dest"</span><span class="p">,</span> <span class="s">"test@testwyre.com"</span><span class="p">);</span>
            <span class="n">HttpWebResponse</span> <span class="n">transferResponse</span> <span class="p">=</span> <span class="n">wyre</span><span class="p">.</span><span class="nf">Post</span><span class="p">(</span><span class="s">"/transfers"</span><span class="p">,</span> <span class="n">body</span><span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="nf">GetResponseBody</span><span class="p">(</span><span class="n">transferResponse</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="k">private</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetResponseBody</span><span class="p">(</span><span class="n">HttpWebResponse</span> <span class="n">response</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">JObject</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">GetResponseStream</span><span class="p">()).</span><span class="nf">ReadToEnd</span><span class="p">()).</span><span class="nf">ToString</span><span class="p">(</span><span class="n">Formatting</span><span class="p">.</span><span class="n">Indented</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">WyreApi</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">const</span> <span class="n">String</span> <span class="n">domain</span> <span class="p">=</span> <span class="s">"https://api.testwyre.com"</span><span class="p">;</span>
        <span class="k">private</span> <span class="k">const</span> <span class="n">String</span> <span class="n">apiKey</span> <span class="p">=</span> <span class="s">"YOUR_API_KEY_HERE"</span><span class="p">;</span>
        <span class="k">private</span> <span class="k">const</span> <span class="n">String</span> <span class="n">secKey</span> <span class="p">=</span> <span class="s">"YOUR_SECRET_KEY_HERE"</span><span class="p">;</span>
        <span class="k">public</span> <span class="n">HttpWebResponse</span> <span class="nf">Get</span><span class="p">(</span><span class="kt">string</span> <span class="n">path</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="nf">Get</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;());</span>
        <span class="p">}</span>
        <span class="k">public</span> <span class="n">HttpWebResponse</span> <span class="nf">Get</span><span class="p">(</span><span class="kt">string</span> <span class="n">path</span><span class="p">,</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="n">queryParams</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="nf">Request</span><span class="p">(</span><span class="s">"GET"</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">queryParams</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">public</span> <span class="n">HttpWebResponse</span> <span class="nf">Post</span><span class="p">(</span><span class="kt">string</span> <span class="n">path</span><span class="p">,</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="n">body</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="nf">Request</span><span class="p">(</span><span class="s">"POST"</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">body</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">private</span> <span class="n">HttpWebResponse</span> <span class="nf">Request</span><span class="p">(</span><span class="kt">string</span> <span class="n">method</span><span class="p">,</span> <span class="kt">string</span> <span class="n">path</span><span class="p">,</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="n">body</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="n">queryParams</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;();</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">method</span><span class="p">.</span><span class="nf">Equals</span><span class="p">(</span><span class="s">"GET"</span><span class="p">))</span>
                <span class="n">queryParams</span> <span class="p">=</span> <span class="n">body</span><span class="p">;</span>
            <span class="n">queryParams</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"timestamp"</span><span class="p">,</span> <span class="nf">GetTimestamp</span><span class="p">());</span>
            <span class="kt">string</span> <span class="n">queryString</span> <span class="p">=</span> <span class="n">queryParams</span><span class="p">.</span><span class="nf">Aggregate</span><span class="p">(</span><span class="s">""</span><span class="p">,</span> <span class="p">(</span><span class="n">previous</span><span class="p">,</span> <span class="n">current</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">previous</span> <span class="p">+</span> <span class="s">"&amp;"</span> <span class="p">+</span> <span class="n">current</span><span class="p">.</span><span class="n">Key</span> <span class="p">+</span> <span class="s">"="</span> <span class="p">+</span> <span class="n">current</span><span class="p">.</span><span class="n">Value</span><span class="p">).</span><span class="nf">Remove</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
            <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">domain</span> <span class="p">+</span> <span class="n">path</span> <span class="p">+</span> <span class="s">"?"</span> <span class="p">+</span> <span class="n">queryString</span><span class="p">;</span>
            <span class="n">HttpWebRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebRequest</span><span class="p">)</span><span class="n">WebRequest</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>
            <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="n">method</span><span class="p">;</span>
            <span class="n">request</span><span class="p">.</span><span class="n">ContentType</span> <span class="p">=</span> <span class="s">"application/json"</span><span class="p">;</span>
            <span class="n">request</span><span class="p">.</span><span class="n">AutomaticDecompression</span> <span class="p">=</span> <span class="n">DecompressionMethods</span><span class="p">.</span><span class="n">GZip</span> <span class="p">|</span> <span class="n">DecompressionMethods</span><span class="p">.</span><span class="n">Deflate</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(!</span><span class="n">method</span><span class="p">.</span><span class="nf">Equals</span><span class="p">(</span><span class="s">"GET"</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="n">url</span> <span class="p">+=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">body</span><span class="p">);</span>
                <span class="k">using</span> <span class="p">(</span><span class="n">StreamWriter</span> <span class="n">writer</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamWriter</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="nf">GetRequestStream</span><span class="p">()))</span>
                    <span class="n">writer</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">body</span><span class="p">));</span>
            <span class="p">}</span>
            <span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">[</span><span class="s">"X-Api-Key"</span><span class="p">]</span> <span class="p">=</span> <span class="n">apiKey</span><span class="p">;</span>
            <span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">[</span><span class="s">"X-Api-Signature"</span><span class="p">]</span> <span class="p">=</span> <span class="nf">CalcAuthSigHash</span><span class="p">(</span><span class="n">secKey</span><span class="p">,</span> <span class="n">url</span><span class="p">);</span>
            <span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">[</span><span class="s">"X-Api-Version"</span><span class="p">]</span> <span class="p">=</span> <span class="s">"2"</span><span class="p">;</span>
            <span class="k">try</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">HttpWebResponse</span><span class="p">)</span><span class="n">request</span><span class="p">.</span><span class="nf">GetResponse</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">catch</span><span class="p">(</span><span class="n">WebException</span> <span class="n">e</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="kt">string</span> <span class="n">msg</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="nf">GetResponseStream</span><span class="p">()).</span><span class="nf">ReadToEnd</span><span class="p">();</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">SystemException</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">private</span> <span class="kt">byte</span><span class="p">[]</span> <span class="nf">GetBytes</span><span class="p">(</span><span class="kt">string</span> <span class="n">str</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">private</span> <span class="kt">string</span> <span class="nf">GetString</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">bytes</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(</span><span class="n">bytes</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">private</span> <span class="kt">long</span> <span class="nf">GetTimestamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// return DateTimeOffset.UtcNow.ToUnixTimeMilliseconds() // .NET 4.6</span>
            <span class="k">return</span> <span class="p">(</span><span class="kt">long</span><span class="p">)(</span><span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">DateTimeKind</span><span class="p">.</span><span class="n">Utc</span><span class="p">)).</span><span class="n">TotalMilliseconds</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">private</span> <span class="n">String</span> <span class="nf">CalcAuthSigHash</span><span class="p">(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="kt">string</span> <span class="k">value</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmac</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">string</span> <span class="n">hash</span> <span class="p">=</span> <span class="nf">GetString</span><span class="p">(</span><span class="n">hmac</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="nf">GetBytes</span><span class="p">(</span><span class="k">value</span><span class="p">))).</span><span class="nf">Replace</span><span class="p">(</span><span class="s">"-"</span><span class="p">,</span> <span class="s">""</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">hash</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>We use a handful of security mechanisms to ensure that your requests are secure. You can find information on how to make a secure authenticated request below.</p>

<p>In order to make an authenticated request you&#39;ll need to pass a couple of values through the HTTP headers with your request:</p>

<table><thead>
<tr>
<th>HTTP Header Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>X-Api-Key</td>
<td>Your API key. Your key can be found <a href="https://dash.testwyre.com/settings/api-keys">here</a></td>
</tr>
<tr>
<td>X-Api-Signature</td>
<td>A signature used to verify the request was sent by the account holder. See Calculating the request signature.</td>
</tr>
</tbody></table>

<p>Additionally, you should include a <code>GET</code> parameter named timestamp which is the current time in <strong>millisecond epoch format</strong>. We use this timestamp to help protect against replay attacks.</p>

<p><strong>Calculating the request signature</strong></p>

<p>If you are sending a <code>GET</code> request you would sign the following (example):  <em>https://api.testwyre.com/v2/rates?timestamp=1426252182534</em><br></p>

<p>If you are making a <code>POST</code> request you would sign the following (example): <em>https://api.testwyre.com/v2/transfers?timestamp=1426252182534</em><br></p>

<p>Note for the <code>POST</code> request, you must append the request body to the string URL. Remember to send the request body exactly as you sign it, whitespace and all. The server calculates the signature based on exactly what&#39;s in the request body. <br></p>

<p>Calculating the X-Api-Signature field is a two step process: <br></p>

<ol>
<li><p>Concatenate the request URL with the body of the HTTP request into a UTF-8 String. Use an empty string for the HTTP body in <code>GET</code> requests. <br></p></li>
<li><p>Compute the signature using HMAC with SHA-256 and your API Secret Key. <br></p></li>
</ol>
<h2 id='srns'>SRNs</h2>
<p>An SRN is a System Resource Name. It is a typed identifier that may reference any object within our platform. Many of our API calls and data schemas leverage SRNs in order to add flexibility and decouple services. All SRNs follow the same format:</p>

<table><thead>
<tr>
<th>type</th>
<th>Identifier</th>
</tr>
</thead><tbody>
<tr>
<td>contact</td>
<td>A contact id (contact:CO-123123123)</td>
</tr>
<tr>
<td>paymentmethod</td>
<td>A payment method such as a bank account (paymentmethod:PA-123123123)</td>
</tr>
<tr>
<td>email</td>
<td>An email address (email:test@epiapi.com)</td>
</tr>
<tr>
<td>cellphone</td>
<td>A cellphone number (cellphone:+8615555555555)</td>
</tr>
<tr>
<td>account</td>
<td>A plafrom account (account:AC-123123123)</td>
</tr>
<tr>
<td>wallet</td>
<td>A single wallet (wallet:WA-123123123)</td>
</tr>
<tr>
<td>transfer</td>
<td>A transfer (possibly including a conversion) of currency (transfer:TF-123123123)</td>
</tr>
</tbody></table>
<h2 id='fees'>Fees</h2>
<p>To understand how are fees are calculated and charged, please refer <a href="XXXXXXXXXXXXXX">here</a>.</p>
<h2 id='error-table'>Error Table</h2>
<p>Successful requests will be a HTTP 200 response after any successful call. The body of successful requests depend on the endpoint. <br></p>

<p>Whenever a problem occurs, we will respond to the client using a 4xx or 5xx status code. In this case, the body of the response will be an exception object which describes the problem. <br></p>

<table><thead>
<tr>
<th>Exception</th>
<th>Description</th>
<th>HTTPs Status Code</th>
</tr>
</thead><tbody>
<tr>
<td>ValidationException</td>
<td>The action failed due to problems with the request.</td>
<td>400</td>
</tr>
<tr>
<td>UnknownException</td>
<td>A problem with our services internally. This should rarely happen.</td>
<td>500</td>
</tr>
<tr>
<td>InsufficientFundsException</td>
<td>You requested the use of more funds in the specified currency than were available.</td>
<td>400</td>
</tr>
<tr>
<td>RateLimitException</td>
<td>Your requests have exceeded your usage restrictions. Please contact us if you need this increased.</td>
<td>429</td>
</tr>
<tr>
<td>AccessDeniedException</td>
<td>You lack sufficient privilege to perform the requested action.</td>
<td>401</td>
</tr>
<tr>
<td>TransferException</td>
<td>There was a problem completing your transfer request.</td>
<td>400</td>
</tr>
<tr>
<td>NotFoundException</td>
<td>You requested something that couldn&#39;t be located.</td>
<td>400</td>
</tr>
<tr>
<td>ValidationException</td>
<td>There was a problem validating the input you supplied.</td>
<td>400</td>
</tr>
<tr>
<td>CustomerSupportException</td>
<td>Please contact us at support@testwyre.com to resolve this!</td>
<td>400</td>
</tr>
<tr>
<td>MFARequiredException</td>
<td>An MFA action is required to complete the request. In general you should not get this exception while using API keys.</td>
<td>400</td>
</tr>
</tbody></table>

<p><br>
All exceptions will carry a subType parameter which exposes more information about the problem. Additionally, some ValidationException errors will carry with them two fields, problematicField and problematicValue, denoting the field which caused the failure.</p>

<p>A few typical ValidationException subtypes:
<br></p>

<p>FIELD_REQUIRED <br>
INVALID_VALUE <br>
TRANSACTION_AMOUNT_TOO_SMALL <br>
UNSUPPORTED_SOURCE_CURRENCY <br>
SENDER_PROVIDED_ID_IN_USE <br>
CANNOT_SEND_SELF_FUNDS <br>
INVALID_PAYMENT_METHOD <br>
PAYMENT_METHOD_INACTIVE <br>
PAYMENT_METHOD_UNSUPPORTED_CHARGE_CURRENCY <br>
PAYMENT_METHOD_UNCHARGEABLE <br>
PAYMENT_METHOD_UNSUPPORTED_DEPOSIT_CURRENCY <br>
PAYMENT_METHOD_UNDEPOSITABLE <br>
PAYMENT_METHOD_DOESNT_SUPPORT_FOLLOWUPS <br>
PAYMENT_METHOD_DOESNT_SUPPORT_MICRODEPOSIT_VERIFICATION <br></p>
<h1 id='step-by-step-guide'>Step-by-step Guide</h1>
<p>This guide will take you through all steps required to build a funds receivables product based on our API.</p>
<h2 id='virtual-banking'>Virtual Banking</h2>
<p><strong>Building a USD receivables business on epiapi</strong></p>

<p>There are many different ways to integrate with our API to provide different types of payments receivables services. To help developers understand how it may be used, weve described a typical use-case below. <br></p>

<p>We will show you an example of how an online platform may create USD virtual bank accounts with unique account numbers for its users, and receive funds for delivery into a dedicated settlement account. <br></p>
<h3 id='step-1-create-a-wallet-with-kyc-data'>Step 1. Create a Wallet with KYC Data</h3>
<p>Wyre uses the concept of <code>wallets</code> to represent individual merchant accounts under your <code>account</code>. Upon creation, each of these wallets are assigned various fund receiving capabilities, for <code>TYPE=VBA</code> wallets a Virtual Bank Account (with a unique bank account and routing number) will be created. <br></p>
<pre class="highlight plaintext"><code>curl -v -XPOST 'https://api.testwyre.com/v2/wallets' \
  -H "Content-Type: application/json" \
  -H "X-Api-Key: {api-key}" \
  -H "X-Api-Signature: {signature}" \
  -d '{"type":"VBA","name":"{your-unique-identifier}"
</code></pre>
<p><code>POST</code> https://api.testwyre.com/v2/wallets <br></p>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"callbackUrl"</span><span class="p">:</span><span class="s2">"https://your.website.io/callback"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"12345678977897800"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"VBA"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"vbaVerificationData"</span><span class="p">:{</span><span class="w">
    </span><span class="s2">"entityType"</span><span class="p">:</span><span class="s2">"CORP"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"entityScope"</span><span class="p">:</span><span class="s2">"Shopping/Retail"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"email"</span><span class="p">:</span><span class="s2">"test+merchant@epiapi.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"phoneNumber"</span><span class="p">:</span><span class="s2">"13111111111"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"ip"</span><span class="p">:</span><span class="s2">"127.0.0.1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"nameCn"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="s2">"nameEn"</span><span class="p">:</span><span class="s2">"Legal Rep"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"dateOfBirth"</span><span class="p">:</span><span class="mi">1514736000</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address"</span><span class="p">:{</span><span class="w">
            </span><span class="s2">"city"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="s2">"country"</span><span class="p">:</span><span class="s2">"CN"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"postalCode"</span><span class="p">:</span><span class="s2">"210000"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"street1"</span><span class="p">:</span><span class="s2">"107"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"street2"</span><span class="p">:</span><span class="s2">"107"</span><span class="p">},</span><span class="w">
        </span><span class="s2">"idNumber"</span><span class="p">:</span><span class="s2">"432524199902287897"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"idDoc"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"merchantIds"</span><span class="p">:[{</span><span class="w">
        </span><span class="s2">"merchantId"</span><span class="p">:</span><span class="s2">"AAAAAAAAAAA"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"merchantType"</span><span class="p">:</span><span class="s2">"Amazon"</span><span class="p">}],</span><span class="w">
    </span><span class="s2">"expectedMonthlySales"</span><span class="p">:</span><span class="mi">40000</span><span class="p">,</span><span class="w">
    </span><span class="s2">"shopName"</span><span class="p">:</span><span class="s2">"MyBrand"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"website"</span><span class="p">:</span><span class="s2">"https://merchant.website.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"repAaddress"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"city"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="s2">"country"</span><span class="p">:</span><span class="s2">"CN"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"postalCode"</span><span class="p">:</span><span class="s2">"210000"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"street1"</span><span class="p">:</span><span class="s2">"107"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"street2"</span><span class="p">:</span><span class="s2">"107"</span><span class="p">},</span><span class="w">
    </span><span class="s2">"companyNameCn"</span><span class="p">:</span><span class="s2">"ABC"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"companyNameEn"</span><span class="p">:</span><span class="s2">"ABC Company Limited"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"registrationNumber"</span><span class="p">:</span><span class="s2">"123456789"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"coiDoc"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"salesDoc"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dateOfEstablishment"</span><span class="p">:</span><span class="mi">1514736000</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficialOwners"</span><span class="p">:[{</span><span class="w">
      </span><span class="s2">"fullName"</span><span class="p">:</span><span class="s2">"Richard"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"idNumber"</span><span class="p">:</span><span class="s2">"1231321312"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"idDoc"</span><span class="p">:</span><span class="kc">null</span><span class="p">}]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Once a new user requests a VBA via your platform, <a href="/#wallets">create a wallet</a> for that user. <br></p>

<p>Note: You should collect the required documentation and pass through to us through this endpoint. The data is used for KYC purposes and is necessary in order to open the virtual banking facilities. The wallet will be opened immediately, and the banking information will be appended to the account once approved (after step 3)</p>

<p>Each wallet will automatically be assigned a walletId.</p>

<p>Take note of the <code>walletId</code> that gets generated in the response as this will be used later to manage the VBA.</p>
<h3 id='step-2-upload-kyc-documents'>Step 2. Upload KYC documents</h3>
<p><code>POST</code> https://api.testwyre.com/v2/documents <br></p>

<p>VBA Wallets require the below documentation in order to be issued with a Virtual Bank <code>accountNumber</code>. When you upload a document using this endpoint you will receive a <code>documentId</code> which you will need for Step 3. <br></p>

<p>When updating pass the following parameters along with the URL:</p>

<table><thead>
<tr>
<th>Field</th>
</tr>
</thead><tbody>
<tr>
<td>ownerSrn: &quot;wallet:[WALLET_ID]&quot;</td>
</tr>
<tr>
<td>filename (optional): &quot;coiDoc.pdf&quot;</td>
</tr>
</tbody></table>

<p>E.g. <code>POST</code> https://api.testwyre.com/v2/documents?ownerSrn=wallet:WA-123123123&amp;filename=coiDoc.pdf</p>

<p>In the body of the request simply include the raw bytes of file to be uploaded.</p>
<pre class="highlight java tab-java"><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">computeSignature2</span><span class="o">(</span><span class="n">String</span> <span class="n">secretKey</span><span class="o">,</span><span class="n">String</span> <span class="n">url</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">reqData</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">UnsupportedEncodingException</span> <span class="o">{</span>

       <span class="kt">byte</span><span class="o">[]</span> <span class="n">urlBytes</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="s">"UTF-8"</span><span class="o">);</span>

       <span class="kt">byte</span><span class="o">[]</span> <span class="n">data</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">urlBytes</span><span class="o">.</span><span class="na">length</span><span class="o">+</span><span class="n">reqData</span><span class="o">.</span><span class="na">length</span><span class="o">];</span>

       <span class="n">System</span><span class="o">.</span><span class="na">arraycopy</span><span class="o">(</span><span class="n">urlBytes</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="n">data</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="n">urlBytes</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
       <span class="n">System</span><span class="o">.</span><span class="na">arraycopy</span><span class="o">(</span><span class="n">reqData</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="n">data</span><span class="o">,</span><span class="n">urlBytes</span><span class="o">.</span><span class="na">length</span><span class="o">,</span><span class="n">reqData</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>

       <span class="k">try</span> <span class="o">{</span>
           <span class="n">Mac</span> <span class="n">sha256Hmac</span> <span class="o">=</span> <span class="n">Mac</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"HmacSHA256"</span><span class="o">);</span>
           <span class="n">SecretKeySpec</span> <span class="n">key</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecretKeySpec</span><span class="o">(</span><span class="n">secretKey</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(),</span> <span class="s">"HmacSHA256"</span><span class="o">);</span>
           <span class="n">sha256Hmac</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>

           <span class="kt">byte</span><span class="o">[]</span> <span class="n">macData</span> <span class="o">=</span> <span class="n">sha256Hmac</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>

           <span class="n">StringBuffer</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="o">();</span>
           <span class="k">for</span> <span class="o">(</span><span class="kd">final</span> <span class="kt">byte</span> <span class="n">element</span> <span class="o">:</span> <span class="n">macData</span><span class="o">){</span>
               <span class="n">result</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">((</span><span class="n">element</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="o">)</span> <span class="o">+</span> <span class="mh">0x100</span><span class="o">,</span> <span class="mi">16</span><span class="o">).</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">));</span>
           <span class="o">}</span>
           <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>

       <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
           <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
           <span class="k">return</span> <span class="s">""</span><span class="o">;</span>
       <span class="o">}</span>
   <span class="o">}</span>
</code></pre>
<p>Finally, the content-type header should reflect the file type - allowed content-types include:</p>

<table><thead>
<tr>
<th>Content Type</th>
</tr>
</thead><tbody>
<tr>
<td>&quot;application/msword&quot;</td>
</tr>
<tr>
<td>&quot;application/vnd.openxmlformats-officedocument.wordprocessingml.document&quot;</td>
</tr>
<tr>
<td>&quot;application/pdf&quot;</td>
</tr>
<tr>
<td>&quot;image/jpg&quot;</td>
</tr>
<tr>
<td>&quot;image/jpeg&quot;</td>
</tr>
<tr>
<td>&quot;image/png&quot;</td>
</tr>
</tbody></table>

<p>Once the file is uploaded the user will receive a &quot;document&quot; object as the response. Take the ID from this (e.g. DO-123123123) and provide it in the coiDoc, idDoc or salesDoc fields.</p>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>idDoc</td>
<td>A government-issued identity document such as a passport or national ID card.</td>
</tr>
<tr>
<td>coiDoc</td>
<td>The company&#39;s Certificate of Incorporation.</td>
</tr>
<tr>
<td>salesDoc</td>
<td>A document detailing the merchant&#39;s recent sales*</td>
</tr>
</tbody></table>

<p>For Amazon - please use the ListFinancialEventsGroup query for the last 90 days to upload a xml file</p>
<h3 id='step-3-update-kyc-data-to-include-documents'>Step 3. Update KYC Data to include documents</h3>
<p>When documents are uploaded they are associated to the wallet according to the ownerSrn. In order to determine the type and the latest documents, please update the following fields in the <code>vbaVerificationData</code>:</p>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"vbaVerificationData"</span><span class="p">:{</span><span class="w">
        </span><span class="s2">"coiDoc"</span><span class="p">:</span><span class="s2">"DO-123123123"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"idDoc"</span><span class="p">:</span><span class="s2">"DO-123123124"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"salesDoc"</span><span class="p">:</span><span class="s2">"DO-123123125"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='step-4-check-for-banking-data'>Step 4. Check for banking data</h3>
<p>Banking data is added as an <code>object</code> to the <code>vbaData</code> setcion of the wallet object.</p>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">   
  </span><span class="s2">"vbaData"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"bankName"</span><span class="p">:</span><span class="s2">"Evolve Bank &amp; Trust"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"bankAddress"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6070 Poplar Ave #100, Memphis TN 38119"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryName"</span><span class="p">:</span><span class="s2">"Zhang San"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"bankAccountNumber"</span><span class="p">:</span><span class="s2">"123123123"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"routingNumber"</span><span class="p">:</span><span class="s2">"084106768"</span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Query the wallet using <code>GET</code> https://api.testwyre.com/v2/wallet/[walletID]. Limit your queries to once per hour and once the data is added turn off the queries. In the future we will add a Callback for this event.</p>

<p>Once received you can now pass this information to your user to update their settlement information with their merchant platform.</p>
<h3 id='step-5-receiving-funds-and-callbacks'>Step 5. Receiving Funds and Callbacks</h3>
<p>Whenever we receive a payment to the <code>accountNumber</code>, once approved (note: payments from unapproved platforms will be rejected) a callback will be sent if you have set up a <code>callbackUrl</code>.</p>

<p>See <a href="#callbacks-2">Callbacks</a></p>

<p>If you wish to validate the callback you can use the <code>id</code> to <code>GET</code> the necessary information. For transfers within our system the id will belong to a transfer (e.g. TF-123123123) and you can query:
<em>https://api.testwyre.com/v2/transfer/[id]</em><br></p>

<p>For the initial funding transation from outside our system (such as Amazon) the id will belong to a transaction (e.g. TR-123123123) and you can query: <em>https://api.testwyre.com/v2//transaction/[id]</em><br></p>
<h3 id='step-6-transfer-usd-from-wallet-to-account'>Step 6. Transfer USD from wallet to Account</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
</span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wallet:walletId"</span><span class="p">,</span><span class="w">
</span><span class="s2">"dest"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wallet:walletId"</span><span class="p">,</span><span class="w">
</span><span class="s2">"sourceCurrency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
</span><span class="s2">"destCurrency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BTC"</span><span class="p">,</span><span class="w">
</span><span class="s2">"destAmount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
</span><span class="s2">"autoConfirm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
</span><span class="s2">"message"</span><span class="p">:</span><span class="s2">"USD Personal example"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><code>POST</code> https://api.testwyre.com/v2/transfers <br></p>

<p>The user decides to buy BTC with a portion of their USD. <br></p>

<p>Create a transfer, initiating a buy of BTC with the USD from that user&#39;s wallet to his/her wallet.</p>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">  
   </span><span class="s2">"source"</span><span class="p">:</span><span class="s2">"account:accoundId"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"sourceCurrency"</span><span class="p">:</span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"sourceAmount"</span><span class="p">:</span><span class="s2">"10000"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"dest"</span><span class="p">:</span><span class="s2">"wallet:walletId"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"destCurrency"</span><span class="p">:</span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"autoConfirm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><code>POST</code> https://api.testwyre.com/v2/transfers <br></p>

<p>Once the user deposits USD on the client&#39;s platform, <a href="http://testwyre.com/docs/#create-transfer">create a transfer</a> on Wyre by sending USD from the master account to that user&#39;s wallet from Step 1 and automatically Confirm Transfer. <br></p>

<p>For <code>source</code>, put your Wyre account ID which can be found <a href="https://www.testwyre.com/settings/basic-info">here</a>.</p>

<p>Set <code>autoConfirm</code> to &quot;true&quot; to automatically confirm the transfer.</p>
<h3 id='step-7-the-user-wants-to-cash-out-their-remaining-usd'>Step 7. The user wants to cash out their remaining USD</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
</span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wallet:walletId"</span><span class="p">,</span><span class="w">
</span><span class="s2">"dest"</span><span class="p">:</span><span class="w"> </span><span class="s2">"account:accountId"</span><span class="p">,</span><span class="w">
</span><span class="s2">"sourceCurrency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
</span><span class="s2">"destCurrency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
</span><span class="s2">"destAmount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
</span><span class="s2">"autoConfirm"</span><span class="p">:</span><span class="s2">"true"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Let&#39;s say the user wants to withdraw their remaining USD balance from the client&#39;s platform. <br></p>

<p>Create a transfer to send the remaining USD balance from the user&#39;s wallet to the master account.<br></p>

<p>Automatically confirm transfer by setting <code>autoConfirm</code> to &quot;true&quot;. <br></p>

<p>Afterwards, the client&#39;s platform should deliver payout to the user from the client&#39;s bank account.</p>
<h1 id='account'>Account</h1><h2 id='account-details'>Account Details</h2>
<p>This endpoint retrieves all the information related to your account. <br></p>

<p><strong>Definition</strong> <br></p>

<p><code>GET</code> https://api.testwyre.com/v2/account <br></p>

<p>When checking your balance you should refer to the <code>availableBalance</code> object to see how much of a given currency you have available to transfer.</p>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ID</td>
<td>An internal id corresponding to your account.</td>
</tr>
<tr>
<td>createdAt</td>
<td>Time at which the account was created.</td>
</tr>
<tr>
<td>updatedAt</td>
<td>The last time the account was updated.</td>
</tr>
<tr>
<td>loginAt</td>
<td>The last time the account was logged in to.</td>
</tr>
<tr>
<td>rank</td>
<td>The account&#39;s rank. Used for things like limits on the accounts option to purchase digital currencies.</td>
</tr>
<tr>
<td>profile</td>
<td>A set of fields that the user has permission to modify.</td>
</tr>
<tr>
<td>paymentMethods</td>
<td>A list of payment methods available on the account.</td>
</tr>
<tr>
<td>identities</td>
<td>An array of identities (cellphone numbers, email addresses) associated with the account. Each identity includes information about when they were created and when they were verified.</td>
</tr>
<tr>
<td>depositAddresses</td>
<td>A map of digital currency deposit addresses for the account.</td>
</tr>
<tr>
<td>totalBalances</td>
<td>A map of the total amount of funds in the user&#39;s account. This is the sum of the pending balances and the available balances.</td>
</tr>
<tr>
<td>availableBalances</td>
<td>A map of the total amount of funds available to be withdrawn immediately from the account. If you are performing a check to see if the account has sufficient funds before making a withdrawal, you should check this balance.</td>
</tr>
<tr>
<td>email</td>
<td>The email tied to the account.</td>
</tr>
<tr>
<td>cellphone</td>
<td>The cellphone number tied to the account.</td>
</tr>
</tbody></table>

<p><strong>Result Format</strong> <br></p>

<pre class="center-column">
{
  "id": "121pd02kt0rnb24nclsg4bglanimurqp",
  "createdAt": 1404177262332,
  "updatedAt": 1404177262332,
  "loginAt": 1404177262332,
  "rank": 0,
  "profile": {
    "firstName": "",
    "lastName": "",
    "locale": "EN_us",
    "address": {
      "street1": null,
      "street2": null,
      "city": null,
      "state": null,
      "postalCode": null,
      "country": "USA"
    },
    "businessAccount": true,
    "taxId": null,
    "doingBusinessAs": null,
    "website": null,
    "dateOfBirth": 1404177262332,
    "notifyEmail": true,
    "notifyCellphone": true,
    "notifyApnsDevice": true,
    "mfaRequiredForPwChange": false,
    "mfaRequiredForDcPurchase": false,
    "mfaRequiredForSendingFunds": false,
    "authyPhoneNumber": null
  },
  "paymentMethods": [],
  "identities": [
    {
      "srn": "email:richard@apiepi.com",
      "createdAt": 1404177262332,
      "verifiedAt": 1404177262332
    }
  ],
  "depositAddresses": {
    "BTC": "1H9K67J9NcYtzmFGojR9cgM5ybxEddySwu"
  },
  "totalBalances": {
    "USD": 11.8934023
  },
  "availableBalances": {
    "USD": 10.8934023,
  },
  "email": "richard@apiepi.com",
  "cellphone": "+12312313112"
}
</pre>
<h1 id='wallets'>Wallets</h1>
<p>If you need to manage your account&#39;s balances into individual buckets, you may choose to use the Wallets API. You can send Bitcoin or Ethereum to the wallet which will be automatically assigned a unique bitcoin or ethereum deposit address.</p>
<h2 id='create-wallet'>Create Wallet</h2><pre class="highlight plaintext"><code>curl -v -XPOST 'https://api.testwyre.com/v2/wallets' \
  -H "Content-Type: application/json" \
  -H "X-Api-Key: {api-key}" \
  -H "X-Api-Signature: {signature}" \
  -d '{"type":"ENTERPRISE","name":"{your-unique-identifier}",
  "callbackUrl":"https://your.website.io/callback",
  "notes":"Notes about the sub account"}'
</code></pre><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">javax.crypto.Mac</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.SecretKeySpec</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.BufferedReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.DataOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStreamReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.Integer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.String</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.StringBuffer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.HttpURLConnection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URL</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">accountId</span> <span class="o">=</span> <span class="s">"k3f48j0rb2rp65c0sdog67vi43u80jas"</span><span class="o">;</span>
    <span class="n">String</span> <span class="n">apiKey</span> <span class="o">=</span> <span class="s">"fll36l3t35udalcqlh4ng6bm4qpbgher"</span><span class="o">;</span>
    <span class="n">String</span> <span class="n">secretKey</span> <span class="o">=</span> <span class="s">"tr3epinbk3maist0n3ijk18bm6dikrq6"</span><span class="o">;</span>

    <span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.testwyre.com/v2/wallets"</span><span class="o">;</span>
    <span class="n">String</span> <span class="n">method</span> <span class="o">=</span> <span class="s">"POST"</span><span class="o">;</span>
    <span class="n">String</span> <span class="n">data</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>

    <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">excuteWyereRequest</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="s">""</span><span class="o">,</span> <span class="n">method</span><span class="o">,</span> <span class="n">apiKey</span><span class="o">,</span> <span class="n">secretKey</span><span class="o">);</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>

    <span class="n">data</span> <span class="o">=</span> <span class="s">"{"</span> <span class="o">+</span>
        <span class="s">"  \"type\":\"ENTERPRISE\","</span> <span class="o">+</span>
        <span class="s">"  \"name\":\"{your-unique-identifier}\","</span> <span class="o">+</span>
        <span class="s">"  \"callbackUrl\":\"https://your.website.io/callback\","</span> <span class="o">+</span>
        <span class="s">"  \"notes\":\"Notes about the user\","</span> <span class="o">+</span>
        <span class="s">"  \"verificationData\": {"</span> <span class="o">+</span>
        <span class="s">"      \"firstName\":\"{users-first-name}\","</span> <span class="o">+</span>
        <span class="s">"      \"middleName\":\"{users-middle-name}\","</span> <span class="o">+</span>
        <span class="s">"      \"lastName\":\"{users-last-name}\","</span> <span class="o">+</span>
        <span class="s">"      \"ssn\":\"0000\","</span> <span class="o">+</span>
        <span class="s">"      \"passport\":\"123456\","</span> <span class="o">+</span>
        <span class="s">"      \"birthDay\":\"1\","</span> <span class="o">+</span>
        <span class="s">"      \"birthMonth\":\"1\","</span> <span class="o">+</span>
        <span class="s">"      \"birthYear\":\"1970\","</span> <span class="o">+</span>
        <span class="s">"      \"phoneNumber\":\"+15555555555\","</span> <span class="o">+</span>
        <span class="s">"      \"address\": {"</span> <span class="o">+</span>
        <span class="s">"          \"street1\":\"1 Market Street\","</span> <span class="o">+</span>
        <span class="s">"          \"street2\":\"Suit 420\","</span> <span class="o">+</span>
        <span class="s">"          \"city\":\"San Francisco\","</span> <span class="o">+</span>
        <span class="s">"          \"state\":\"CA\","</span> <span class="o">+</span>
        <span class="s">"          \"postalCode\":\"94105\","</span> <span class="o">+</span>
        <span class="s">"          \"country\":\"US\""</span> <span class="o">+</span>
        <span class="s">"      }"</span> <span class="o">+</span>
        <span class="s">"  }"</span> <span class="o">+</span>
        <span class="s">"}"</span><span class="o">;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">excuteWyreRequest</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="n">data</span><span class="o">,</span> <span class="n">method</span><span class="o">,</span> <span class="n">apiKey</span><span class="o">,</span> <span class="n">secretKey</span><span class="o">);</span>

    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">excuteWyreRequest</span><span class="o">(</span><span class="n">String</span> <span class="n">targetURL</span><span class="o">,</span> <span class="n">String</span> <span class="n">requestBody</span><span class="o">,</span> <span class="n">String</span> <span class="n">method</span><span class="o">,</span> <span class="n">String</span> <span class="n">apiKey</span><span class="o">,</span> <span class="n">String</span> <span class="n">secretKey</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">URL</span> <span class="n">url</span><span class="o">;</span>
    <span class="n">HttpURLConnection</span> <span class="n">connection</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">{</span>

      <span class="n">targetURL</span> <span class="o">+=</span> <span class="o">((</span><span class="n">targetURL</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="s">"?"</span><span class="o">)&gt;</span><span class="mi">0</span><span class="o">)?</span><span class="s">"&amp;"</span><span class="o">:</span><span class="s">"?"</span><span class="o">)</span> <span class="o">+</span> <span class="s">"timestamp="</span> <span class="o">+</span> <span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>

      <span class="c1">//Create connection</span>
      <span class="n">url</span> <span class="o">=</span> <span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="n">targetURL</span><span class="o">);</span>
      <span class="n">connection</span> <span class="o">=</span> <span class="o">(</span><span class="n">HttpURLConnection</span><span class="o">)</span><span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
      <span class="n">connection</span><span class="o">.</span><span class="na">setRequestMethod</span><span class="o">(</span><span class="n">method</span><span class="o">);</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">connection</span><span class="o">.</span><span class="na">getRequestMethod</span><span class="o">());</span>

      <span class="n">connection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">);</span>
      <span class="n">connection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"Content-Length"</span><span class="o">,</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">requestBody</span><span class="o">.</span><span class="na">getBytes</span><span class="o">().</span><span class="na">length</span><span class="o">));</span>

      <span class="c1">//Specify API v2</span>
      <span class="n">connection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"X-Api-Version"</span><span class="o">,</span><span class="s">"2"</span><span class="o">);</span>

      <span class="c1">// Provide API key and signature</span>
      <span class="n">connection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"X-Api-Key"</span><span class="o">,</span> <span class="n">apiKey</span><span class="o">);</span>
      <span class="n">connection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"X-Api-Signature"</span><span class="o">,</span><span class="n">computeSignature</span><span class="o">(</span><span class="n">secretKey</span><span class="o">,</span><span class="n">targetURL</span><span class="o">,</span><span class="n">requestBody</span><span class="o">));</span>

      <span class="c1">//Send request</span>
      <span class="k">if</span><span class="o">(</span><span class="n">method</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"POST"</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">connection</span><span class="o">.</span><span class="na">setDoOutput</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
        <span class="n">connection</span><span class="o">.</span><span class="na">setRequestMethod</span><span class="o">(</span><span class="n">method</span><span class="o">);</span>

        <span class="n">DataOutputStream</span> <span class="n">wr</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DataOutputStream</span><span class="o">(</span>
            <span class="n">connection</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">());</span>

        <span class="n">wr</span><span class="o">.</span><span class="na">writeBytes</span><span class="o">(</span><span class="n">requestBody</span><span class="o">);</span>
        <span class="n">wr</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
        <span class="n">wr</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
      <span class="o">}</span>

      <span class="c1">//Get Response</span>
      <span class="n">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span>
      <span class="n">BufferedReader</span> <span class="n">rd</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">InputStreamReader</span><span class="o">(</span><span class="n">is</span><span class="o">));</span>
      <span class="n">String</span> <span class="n">line</span><span class="o">;</span>
      <span class="n">StringBuffer</span> <span class="n">response</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="o">();</span>
      <span class="k">while</span><span class="o">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">response</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">line</span><span class="o">);</span>
        <span class="n">response</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="sc">'\r'</span><span class="o">);</span>
      <span class="o">}</span>
      <span class="n">rd</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
      <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>

    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>

      <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
      <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>

    <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>

      <span class="k">if</span><span class="o">(</span><span class="n">connection</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">connection</span><span class="o">.</span><span class="na">disconnect</span><span class="o">();</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">computeSignature</span><span class="o">(</span><span class="n">String</span> <span class="n">secretKey</span><span class="o">,</span> <span class="n">String</span> <span class="n">url</span><span class="o">,</span> <span class="n">String</span> <span class="n">reqData</span><span class="o">)</span> <span class="o">{</span>

    <span class="n">String</span> <span class="n">data</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="n">reqData</span><span class="o">;</span>

    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>

    <span class="k">try</span> <span class="o">{</span>
      <span class="n">Mac</span> <span class="n">sha256Hmac</span> <span class="o">=</span> <span class="n">Mac</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"HmacSHA256"</span><span class="o">);</span>
      <span class="n">SecretKeySpec</span> <span class="n">key</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecretKeySpec</span><span class="o">(</span><span class="n">secretKey</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(),</span> <span class="s">"HmacSHA256"</span><span class="o">);</span>
      <span class="n">sha256Hmac</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>

      <span class="kt">byte</span><span class="o">[]</span> <span class="n">macData</span> <span class="o">=</span> <span class="n">sha256Hmac</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>

      <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
      <span class="k">for</span> <span class="o">(</span><span class="kd">final</span> <span class="kt">byte</span> <span class="n">element</span> <span class="o">:</span> <span class="n">macData</span><span class="o">){</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">((</span><span class="n">element</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="o">)</span> <span class="o">+</span> <span class="mh">0x100</span><span class="o">,</span> <span class="mi">16</span><span class="o">).</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
      <span class="o">}</span>
      <span class="k">return</span> <span class="n">result</span><span class="o">;</span>

    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
      <span class="k">return</span> <span class="s">""</span><span class="o">;</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c">#dependencies:</span>
<span class="c">#python3</span>
<span class="c">#pip3 install requests</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">requests</span> <span class="kn">import</span> <span class="n">request</span>

<span class="k">class</span> <span class="nc">MassPay_API</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_id</span><span class="p">,</span> <span class="n">api_version</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">api_secret</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">account_id</span> <span class="o">=</span> <span class="n">account_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_url</span> <span class="o">=</span> <span class="s">'https://api.testwyre.com/{}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">api_version</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_version</span> <span class="o">=</span> <span class="n">api_version</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="n">api_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_secret</span> <span class="o">=</span> <span class="n">api_secret</span>

    <span class="c">#authentication decorator. May raise ValueError if no json content is returned</span>
    <span class="k">def</span> <span class="nf">authenticate_request</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">wrap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">url</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">body</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
            <span class="n">url</span> <span class="o">+=</span> <span class="s">'?timestamp={}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
            <span class="n">bodyJson</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span> <span class="k">if</span> <span class="n">body</span> <span class="o">!=</span> <span class="s">''</span> <span class="k">else</span> <span class="s">''</span>
            <span class="n">headers</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">headers</span><span class="p">[</span><span class="s">'Content-Type'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'application/json'</span>
            <span class="n">headers</span><span class="p">[</span><span class="s">'X-Api-Version'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_version</span>
            <span class="n">headers</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span>
            <span class="n">headers</span><span class="p">[</span><span class="s">'X-Api-Signature'</span><span class="p">]</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">api_secret</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">),</span> <span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">bodyJson</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">),</span> <span class="s">'SHA256'</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
            <span class="k">print</span><span class="p">(</span><span class="n">headers</span><span class="p">[</span><span class="s">'X-Api-Signature'</span><span class="p">])</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span> <span class="k">if</span> <span class="n">body</span> <span class="o">!=</span> <span class="s">''</span> <span class="k">else</span> <span class="bp">None</span><span class="p">),</span> <span class="n">json</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span> <span class="c">#Wyre will always try to give an err body</span>
                <span class="k">return</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="k">return</span> <span class="mi">404</span><span class="p">,</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="n">wrap</span>

    <span class="nd">@authenticate_request</span>
    <span class="k">def</span> <span class="nf">create_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">callbackUrl</span><span class="p">,</span> <span class="n">notes</span><span class="p">,</span> <span class="n">verificationData</span><span class="p">):</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_url</span> <span class="o">+</span> <span class="s">'/wallets'</span>
        <span class="n">method</span> <span class="o">=</span> <span class="s">'POST'</span>
        <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s">'name'</span><span class="p">:</span><span class="n">name</span><span class="p">,</span>
                <span class="s">'verificationData'</span><span class="p">:</span><span class="n">verificationData</span><span class="p">,</span>
                <span class="s">'type'</span><span class="p">:</span><span class="s">'ENTERPRISE'</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">callbackUrl</span><span class="p">:</span>
            <span class="n">body</span><span class="p">[</span><span class="s">"callbackUrl"</span><span class="p">]</span> <span class="o">=</span> <span class="n">callbackUrl</span>
        <span class="k">if</span> <span class="n">notes</span><span class="p">:</span>
            <span class="n">body</span><span class="p">[</span><span class="s">'notes'</span><span class="p">]</span> <span class="o">=</span> <span class="n">notes</span>
        <span class="k">return</span> <span class="n">url</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">body</span>

<span class="c">#USAGE Example</span>
<span class="n">account_id</span> <span class="o">=</span> <span class="s">"YOUR_ACCOUNT_ID_HERE"</span> <span class="c">#optional</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"YOUR_API_KEY_HERE"</span>
<span class="n">secret_key</span> <span class="o">=</span> <span class="s">"YOUR_SECRET_KEY_HERE"</span>
<span class="n">api_version</span> <span class="o">=</span> <span class="s">"2"</span>

<span class="c">#create Wyre MassPay API object</span>
<span class="n">Wyre</span> <span class="o">=</span> <span class="n">MassPay_API</span><span class="p">(</span><span class="n">account_id</span><span class="p">,</span> <span class="n">api_version</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">)</span>

<span class="c">#create user and print result</span>
<span class="n">http_code</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="n">Wyre</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span>
                                <span class="s">"{your-unique-identifier}"</span><span class="p">,</span>
                                <span class="s">"https://your.website.io/callback"</span><span class="p">,</span>
                                <span class="bp">None</span><span class="p">,</span> <span class="c">#notes</span>
                                <span class="p">{</span>
                                  <span class="s">"firstName"</span><span class="p">:</span> <span class="s">"{users-first-name}"</span><span class="p">,</span>
                                  <span class="s">"middleName"</span><span class="p">:</span> <span class="s">"{users-middle-name}"</span><span class="p">,</span>
                                  <span class="s">"lastName"</span><span class="p">:</span> <span class="s">"{users-last-name}"</span><span class="p">,</span>
                                  <span class="s">"ssn"</span><span class="p">:</span> <span class="s">"0000"</span><span class="p">,</span>
                                  <span class="s">"passport"</span><span class="p">:</span> <span class="s">"123456"</span><span class="p">,</span>
                                  <span class="s">"birthDay"</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span>
                                  <span class="s">"birthMonth"</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span>
                                  <span class="s">"birthYear"</span><span class="p">:</span> <span class="s">"1970"</span><span class="p">,</span>
                                  <span class="s">"phoneNumber"</span><span class="p">:</span> <span class="s">"+15555555555"</span><span class="p">,</span>
                                  <span class="s">"address"</span><span class="p">:</span> <span class="p">{</span>
                                    <span class="s">"street1"</span><span class="p">:</span><span class="s">"1 Market Street"</span><span class="p">,</span>
                                    <span class="s">"street2"</span><span class="p">:</span><span class="s">"Suite 420"</span><span class="p">,</span>
                                    <span class="s">"city"</span><span class="p">:</span><span class="s">"San Francisco"</span><span class="p">,</span>
                                    <span class="s">"state"</span><span class="p">:</span><span class="s">"CA"</span><span class="p">,</span>
                                    <span class="s">"postalCode"</span><span class="p">:</span><span class="s">"94105"</span><span class="p">,</span>
                                    <span class="s">"country"</span><span class="p">:</span><span class="s">"US"</span>
                                  <span class="p">}</span>
                                <span class="p">})</span>
<span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="n">users_srn</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s">'srn'</span><span class="p">]</span> <span class="c">#grab our srn identifier for the user</span>
<span class="s">'''

'''</span><span class="n">php</span>
<span class="o">&lt;</span><span class="err">?</span><span class="n">php</span>
    <span class="n">function</span> <span class="n">make_authenticated_request</span><span class="p">(</span><span class="err">$</span><span class="n">endpoint</span><span class="p">,</span> <span class="err">$</span><span class="n">method</span><span class="p">,</span> <span class="err">$</span><span class="n">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="err">$</span><span class="n">url</span> <span class="o">=</span> <span class="s">'https://api.testwyre.com'</span><span class="p">;</span>
        <span class="err">$</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">"bh405n7stsuo5ut30iftrsl71b4iqjnv"</span><span class="p">;</span>
        <span class="err">$</span><span class="n">secret_key</span> <span class="o">=</span> <span class="s">"a19cvrchgja82urvn47kirrlrrb7stgg"</span><span class="p">;</span>

        <span class="err">$</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">floor</span><span class="p">(</span><span class="n">microtime</span><span class="p">(</span><span class="n">true</span><span class="p">)</span><span class="o">*</span><span class="mi">1000</span><span class="p">);</span>
        <span class="err">$</span><span class="n">request_url</span> <span class="o">=</span> <span class="err">$</span><span class="n">url</span> <span class="o">.</span> <span class="err">$</span><span class="n">endpoint</span><span class="p">;</span>

        <span class="k">if</span><span class="p">(</span><span class="n">strpos</span><span class="p">(</span><span class="err">$</span><span class="n">request_url</span><span class="p">,</span><span class="s">"?"</span><span class="p">))</span>
            <span class="err">$</span><span class="n">request_url</span> <span class="o">.=</span> <span class="s">'&amp;timestamp='</span> <span class="o">.</span> <span class="err">$</span><span class="n">timestamp</span><span class="p">;</span>
        <span class="k">else</span>
            <span class="err">$</span><span class="n">request_url</span> <span class="o">.=</span> <span class="s">'?timestamp='</span> <span class="o">.</span> <span class="err">$</span><span class="n">timestamp</span><span class="p">;</span>

        <span class="k">if</span><span class="p">(</span><span class="err">!</span><span class="n">empty</span><span class="p">(</span><span class="err">$</span><span class="n">body</span><span class="p">))</span>
            <span class="err">$</span><span class="n">body</span> <span class="o">=</span> <span class="n">json_encode</span><span class="p">(</span><span class="err">$</span><span class="n">body</span><span class="p">,</span> <span class="n">JSON_FORCE_OBJECT</span><span class="p">);</span>
        <span class="k">else</span>
            <span class="err">$</span><span class="n">body</span> <span class="o">=</span> <span class="s">''</span><span class="p">;</span>

        <span class="err">$</span><span class="n">headers</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span>
            <span class="s">"Content-Type: application/json"</span><span class="p">,</span>
            <span class="s">"X-Api-Key: "</span><span class="o">.</span> <span class="err">$</span><span class="n">api_key</span><span class="p">,</span>
            <span class="s">"X-Api-Signature: "</span><span class="o">.</span> <span class="n">calc_auth_sig_hash</span><span class="p">(</span><span class="err">$</span><span class="n">secret_key</span><span class="p">,</span> <span class="err">$</span><span class="n">request_url</span> <span class="o">.</span> <span class="err">$</span><span class="n">body</span><span class="p">),</span>
            <span class="s">"X-Api-Version: 2"</span>
        <span class="p">);</span>
        <span class="err">$</span><span class="n">curl</span> <span class="o">=</span> <span class="n">curl_init</span><span class="p">();</span>

        <span class="k">if</span><span class="p">(</span><span class="err">$</span><span class="n">method</span><span class="o">==</span><span class="s">"POST"</span><span class="p">){</span>
          <span class="err">$</span><span class="n">options</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span>
            <span class="n">CURLOPT_URL</span>             <span class="o">=&gt;</span> <span class="err">$</span><span class="n">request_url</span><span class="p">,</span>
            <span class="n">CURLOPT_POST</span>            <span class="o">=&gt;</span>  <span class="n">true</span><span class="p">,</span>
            <span class="n">CURLOPT_POSTFIELDS</span>      <span class="o">=&gt;</span> <span class="err">$</span><span class="n">body</span><span class="p">,</span>
            <span class="n">CURLOPT_RETURNTRANSFER</span>  <span class="o">=&gt;</span> <span class="n">true</span><span class="p">);</span>
        <span class="p">}</span><span class="k">else</span> <span class="p">{</span>
          <span class="err">$</span><span class="n">options</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span>
            <span class="n">CURLOPT_URL</span>             <span class="o">=&gt;</span> <span class="err">$</span><span class="n">request_url</span><span class="p">,</span>
            <span class="n">CURLOPT_RETURNTRANSFER</span>  <span class="o">=&gt;</span> <span class="n">true</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">curl_setopt_array</span><span class="p">(</span><span class="err">$</span><span class="n">curl</span><span class="p">,</span> <span class="err">$</span><span class="n">options</span><span class="p">);</span>
        <span class="n">curl_setopt</span><span class="p">(</span><span class="err">$</span><span class="n">curl</span><span class="p">,</span> <span class="n">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="err">$</span><span class="n">headers</span><span class="p">);</span>
        <span class="err">$</span><span class="n">result</span> <span class="o">=</span> <span class="n">curl_exec</span><span class="p">(</span><span class="err">$</span><span class="n">curl</span><span class="p">);</span>
        <span class="n">curl_close</span><span class="p">(</span><span class="err">$</span><span class="n">curl</span><span class="p">);</span>
        <span class="n">var_dump</span><span class="p">(</span><span class="err">$</span><span class="n">result</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">json_decode</span><span class="p">(</span><span class="err">$</span><span class="n">result</span><span class="p">,</span> <span class="n">true</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">function</span> <span class="n">calc_auth_sig_hash</span><span class="p">(</span><span class="err">$</span><span class="n">seckey</span><span class="p">,</span> <span class="err">$</span><span class="n">val</span><span class="p">)</span> <span class="p">{</span>
        <span class="err">$</span><span class="nb">hash</span> <span class="o">=</span> <span class="n">hash_hmac</span><span class="p">(</span><span class="s">'sha256'</span><span class="p">,</span> <span class="err">$</span><span class="n">val</span><span class="p">,</span> <span class="err">$</span><span class="n">seckey</span><span class="p">);</span>
        <span class="k">return</span> <span class="err">$</span><span class="nb">hash</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="err">$</span><span class="n">userData</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span>
      <span class="s">"type"</span><span class="o">=&gt;</span><span class="s">"ENTERPRISE"</span><span class="p">,</span>
      <span class="s">"name"</span><span class="o">=&gt;</span><span class="s">"{your-unique-identifier}"</span><span class="p">,</span>
      <span class="s">"callbackUrl"</span><span class="o">=&gt;</span><span class="s">"https://your.website.io/callback"</span><span class="p">,</span>
      <span class="s">"notes"</span><span class="o">=&gt;</span> <span class="s">"Notes about the user"</span><span class="p">,</span>
      <span class="s">"verificationData"</span><span class="o">=&gt;</span> <span class="n">array</span><span class="p">(</span>
          <span class="s">"firstName"</span><span class="o">=&gt;</span> <span class="s">"{users-first-name}"</span><span class="p">,</span>
          <span class="s">"middleName"</span><span class="o">=&gt;</span> <span class="s">"{users-middle-name}"</span><span class="p">,</span>
          <span class="s">"lastName"</span><span class="o">=&gt;</span> <span class="s">"{users-last-name}"</span><span class="p">,</span>
          <span class="s">"ssn"</span><span class="o">=&gt;</span> <span class="s">"0000"</span><span class="p">,</span>
          <span class="s">"passport"</span><span class="o">=&gt;</span> <span class="s">"12345"</span><span class="p">,</span>
          <span class="s">"birthDay"</span><span class="o">=&gt;</span> <span class="s">"1"</span><span class="p">,</span>
          <span class="s">"birthMonth"</span><span class="o">=&gt;</span> <span class="s">"1"</span><span class="p">,</span>
          <span class="s">"birthYear"</span><span class="o">=&gt;</span> <span class="s">"1970"</span><span class="p">,</span>
          <span class="s">"phoneNumber"</span><span class="o">=&gt;</span> <span class="s">"+15555555555"</span><span class="p">,</span>
          <span class="s">"address"</span><span class="o">=&gt;</span> <span class="n">array</span><span class="p">(</span>
            <span class="s">"street1"</span><span class="p">:</span><span class="s">"1 Market Street"</span><span class="p">,</span>
            <span class="s">"street2"</span><span class="p">:</span><span class="s">"Suite 420"</span><span class="p">,</span>
            <span class="s">"city"</span><span class="p">:</span><span class="s">"San Francisco"</span><span class="p">,</span>
            <span class="s">"state"</span><span class="p">:</span><span class="s">"CA"</span><span class="p">,</span>
            <span class="s">"postalCode"</span><span class="p">:</span><span class="s">"94105"</span><span class="p">,</span>
            <span class="s">"country"</span><span class="p">:</span><span class="s">"US"</span>
          <span class="p">)</span>
        <span class="p">)</span>
      <span class="p">);</span>
    <span class="n">echo</span> <span class="n">make_authenticated_request</span><span class="p">(</span><span class="s">"/wallets"</span><span class="p">,</span> <span class="s">"POST"</span><span class="p">,</span> <span class="err">$</span><span class="n">userData</span><span class="p">);</span>
<span class="err">?</span><span class="o">&gt;</span>
</code></pre>
<p><strong>Definition</strong> <br></p>

<p><code>POST</code> https://api.testwyre.com/v2/wallets <br></p>

<p><strong>Parameters</strong></p>

<table><thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>string</td>
<td>Unique identifier for the user</td>
<td>yes</td>
</tr>
<tr>
<td>callbackUrl</td>
<td>string</td>
<td>Callback url we will make HTTP postbacks to on wallet updates</td>
<td>no</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>The type of wallet you are creating; defaults to <code>DEFAULT</code></td>
<td>no</td>
</tr>
<tr>
<td>notes</td>
<td>string</td>
<td>Notes about the user</td>
<td>no</td>
</tr>
</tbody></table>

<p><strong>Result Format</strong></p>

<pre class="center-column">
{
  "name" : "{your-unique-identifier}",
  "id" : "WA-AYBNA3lBiWAM4l3",
  "depositAddresses" : {
    "BTC" : "2ShL7kzSNNxedit6hC2fjSQhVcAucTeS1m7"
  },
  "totalBalances" : {
    "BTC" : 0
  },
  "availableBalances" : {
    "BTC" : 0
  },
  "srn" : "wallet:AYBNA3lBiWAM4l3",
  "balances" : {
    "BTC" : 0
  },
  "callbackUrl" : "https://your.website.io/callback",
  "notes" : "Notes about the user"
}
</pre>
<h2 id='create-mulitple-wallets'>Create Mulitple Wallets</h2><pre class="highlight plaintext"><code>
curl -XPOST 'https://api.testwyre.com/v2/wallets/batch?pretty' \
-H 'Content-Type:application/json' \
-d '{
  "wallets":[
    {"name":"walletOne"},
    {"name":"walletTwo"},
    {"name":"walletThree"}
  ]
}'
</code></pre>
<p>This endpoint allows you to creates a batch of child wallets (1 child wallet/user) in one request. <br></p>

<p><strong>Definition</strong> <br></p>

<p><code>POST</code> https://api.testwyre.com/v2/wallets/batch <br></p>

<p><strong>Parameters</strong></p>

<table><thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead><tbody>
<tr>
<td>wallets</td>
<td>array</td>
<td>array of wallet creation objects</td>
<td>yes</td>
</tr>
</tbody></table>

<p><strong>Result Format</strong></p>

<pre class="center-column">
{
  "name" : "walletOne",
  "id" : "AxVA57edP0H33x3",
  "notes" : null,
  "srn" : "wallet:AxVA57edP0H33x3",
  "callbackUrl" : null,
  "verificationData" : null,
  "depositAddresses" : {
    "BTC" : "2ShKKFb9gEP5uvRXtMbs7ykJAMPgoSSnSWB"
  },
  "totalBalances" : {
    "BTC" : 0
  },
  "availableBalances" : {
    "BTC" : 0
  },
  "balances" : {
    "BTC" : 0
  }
}, {
  "name" : "walletTwo",
  "id" : "AtEhoXje3C1V5zq",
  "notes" : null,
  "srn" : "wallet:AtEhoXje3C1V5zq",
  "callbackUrl" : null,
  "verificationData" : null,
  "depositAddresses" : {
    "BTC" : "2ShKndBJNHvzABhBzLxvfzzD2vt64C36dPc"
  },
  "totalBalances" : {
    "BTC" : 0
  },
  "availableBalances" : {
    "BTC" : 0
  },
  "balances" : {
    "BTC" : 0
  }
}, {
  "name" : "walletThree",
  "id" : "U07tSKMvofeMmx0",
  "notes" : null,
  "srn" : "wallet:U07tSKMvofeMmx0",
  "callbackUrl" : null,
  "verificationData" : null,
  "depositAddresses" : {
    "BTC" : "2ShJsBPUb4HrNtgaNZk3YQSi2ynpZ5YY7sT"
  },
  "totalBalances" : {
    "BTC" : 0

  },
  "availableBalances" : {
    "BTC" : 0
  },
  "balances" : {
    "BTC" : 0
  }
}
</pre>
<h2 id='lookup-wallet'>Lookup Wallet</h2>
<p>Lookup by user ID:</p>
<pre class="highlight plaintext"><code>curl -v -XGET 'https://api.testwyre.com/v2/wallet/{wallet-id}' \
  -H "X-Api-Key: {api-key}" \
  -H "X-Api-Signature: {signature}" \
</code></pre>
<p>Lookup by user name:</p>
<pre class="highlight plaintext"><code>curl -v -XGET 'https://api.testwyre.com/v2/wallet' \
  -H "X-Api-Key: {api-key}" \
  -H "X-Api-Signature: {signature}" \
  -d name={your-identifier}
</code></pre>
<p>This endpoint allows you to look up the balance of a child wallet by ID or name. <br></p>

<p><strong>Definition</strong> <br></p>

<p><code>GET</code> https://api.testwyre.com/v2/wallet/{walletId} <br></p>

<p><strong>Parameters</strong> <br></p>

<table><thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead><tbody>
<tr>
<td>walletId</td>
<td>string</td>
<td>ID of the wallet</td>
<td>yes</td>
</tr>
</tbody></table>

<p><strong>Definition</strong> <br></p>

<p><code>GET</code> https://api.testwyre.com/v2/wallet/ <br></p>

<p><strong>Parameters</strong> <br></p>

<table><thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>string</td>
<td>name of the wallet</td>
<td>yes</td>
</tr>
</tbody></table>

<p><strong>Results Format</strong> <br></p>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
   </span><span class="s2">"owner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"account:[account-ID]"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"callbackUrl"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"depositAddresses"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="s2">"BTC"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1FNAkNVt3gXdS3PZ1tDvetbcafKPsJPQTG"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"totalBalances"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="s2">"USD"</span><span class="p">:</span><span class="w"> </span><span class="mf">4.96</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"availableBalances"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="s2">"USD"</span><span class="p">:</span><span class="w"> </span><span class="mf">4.96</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"verificationData"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"balances"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="s2">"USD"</span><span class="p">:</span><span class="w"> </span><span class="mf">4.96</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"srn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wallet:[Wallet-ID]"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="mi">1497861843000</span><span class="p">,</span><span class="w">
   </span><span class="s2">"notes"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test1"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"richard"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[Wallet-ID]"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h2 id='edit-wallet'>Edit Wallet</h2><pre class="highlight plaintext"><code>curl -v -XPOST 'https://api.testwyre.com/v2/wallet/{wallet-id}/update' \
  -H "Content-Type: application/json" \
  -H "X-Api-Key: {api-key}" \
  -H "X-Api-Signature: {signature}" \
  -d '{"name":"{your-unique-identifier}","notes":"Updated notes about the sub account"}'
</code></pre><pre class="highlight python tab-python"><code><span class="c">#dependencies:</span>
<span class="c">#python3</span>
<span class="c">#pip3 install requests</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">requests</span> <span class="kn">import</span> <span class="n">request</span>

<span class="k">class</span> <span class="nc">MassPay_API</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_id</span><span class="p">,</span> <span class="n">api_version</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">api_secret</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">account_id</span> <span class="o">=</span> <span class="n">account_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_url</span> <span class="o">=</span> <span class="s">'https://api.testwyre.com/{}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">api_version</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_version</span> <span class="o">=</span> <span class="n">api_version</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="n">api_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_secret</span> <span class="o">=</span> <span class="n">api_secret</span>

    <span class="c">#authentication decorator. May raise ValueError if no json content is returned</span>
    <span class="k">def</span> <span class="nf">authenticate_request</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">wrap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">url</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">body</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
            <span class="n">url</span> <span class="o">+=</span> <span class="s">'?timestamp={}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
            <span class="n">bodyJson</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span> <span class="k">if</span> <span class="n">body</span> <span class="o">!=</span> <span class="s">''</span> <span class="k">else</span> <span class="s">''</span>
            <span class="n">headers</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">headers</span><span class="p">[</span><span class="s">'Content-Type'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'application/json'</span>
            <span class="n">headers</span><span class="p">[</span><span class="s">'X-Api-Version'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_version</span>
            <span class="n">headers</span><span class="p">[</span><span class="s">'X-Api-Key'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span>
            <span class="n">headers</span><span class="p">[</span><span class="s">'X-Api-Signature'</span><span class="p">]</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">api_secret</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">),</span> <span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">bodyJson</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">),</span> <span class="s">'SHA256'</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
            <span class="k">print</span><span class="p">(</span><span class="n">headers</span><span class="p">[</span><span class="s">'X-Api-Signature'</span><span class="p">])</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span> <span class="k">if</span> <span class="n">body</span> <span class="o">!=</span> <span class="s">''</span> <span class="k">else</span> <span class="bp">None</span><span class="p">),</span> <span class="n">json</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span> <span class="c">#Wyre will always try to give an err body</span>
                <span class="k">return</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="k">return</span> <span class="mi">404</span><span class="p">,</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="n">wrap</span>

    <span class="nd">@authenticate_request</span>
    <span class="k">def</span> <span class="nf">update_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">walletId</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">callbackUrl</span><span class="p">,</span> <span class="n">notes</span><span class="p">,</span> <span class="n">verificationData</span><span class="p">):</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_url</span> <span class="o">+</span> <span class="s">'/wallet/'</span> <span class="o">+</span> <span class="n">walletId</span> <span class="o">+</span> <span class="s">'/update</span><span class="err">
</span><span class="s">        method = '</span><span class="n">POST</span><span class="s">'</span><span class="err">
</span><span class="s">        body = {'</span><span class="n">name</span><span class="s">':name}</span><span class="err">
</span><span class="s">        if callbackUrl:</span><span class="err">
</span><span class="s">            body["callbackUrl"] = callbackUrl</span><span class="err">
</span><span class="s">        if notes:</span><span class="err">
</span><span class="s">            body['</span><span class="n">notes</span><span class="s">'] = notes</span><span class="err">
</span><span class="s">        if verificationData:</span><span class="err">
</span><span class="s">            body['</span><span class="n">verificationData</span><span class="s">'] = verificationData</span><span class="err">
</span><span class="s">        return url, method, body</span><span class="err">

</span><span class="s">#USAGE Example</span><span class="err">
</span><span class="s">account_id = "YOUR_ACCOUNT_ID_HERE" #optional</span><span class="err">
</span><span class="s">api_key = "YOUR_API_KEY_HERE"</span><span class="err">
</span><span class="s">secret_key = "YOUR_SECRET_KEY_HERE"</span><span class="err">
</span><span class="s">api_version = "2"</span><span class="err">

</span><span class="s">#create Wyre MassPay API object</span><span class="err">
</span><span class="s">Wyre = MassPay_API(account_id, api_version, api_key, secret_key)</span><span class="err">

</span><span class="s">#create user and print result</span><span class="err">
</span><span class="s">http_code, result = Wyre.update_user(</span><span class="err">
</span><span class="s">                                "{wallet-id}",</span><span class="err">
</span><span class="s">                                "{your-unique-identifier}",</span><span class="err">
</span><span class="s">                                None, #callbackUrl</span><span class="err">
</span><span class="s">                                "Updated notes for user",</span><span class="err">
</span><span class="s">                                None #verification data</span><span class="err">
</span><span class="s">                                )</span><span class="err">
</span><span class="s">print(result)</span><span class="err">
</span><span class="s">users_srn = result['</span><span class="n">srn</span><span class="s">'] #grab our srn identifier for the user</span><span class="err">
</span></code></pre><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">javax.crypto.Mac</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.SecretKeySpec</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.BufferedReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.DataOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStreamReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.Integer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.String</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.StringBuffer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.HttpURLConnection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URL</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">accountId</span> <span class="o">=</span> <span class="s">"k3f48j0rb2rp65c0sdog67vi43u80jas"</span><span class="o">;</span>
    <span class="n">String</span> <span class="n">apiKey</span> <span class="o">=</span> <span class="s">"fll36l3t35udalcqlh4ng6bm4qpbgher"</span><span class="o">;</span>
    <span class="n">String</span> <span class="n">secretKey</span> <span class="o">=</span> <span class="s">"tr3epinbk3maist0n3ijk18bm6dikrq6"</span><span class="o">;</span>

    <span class="n">String</span> <span class="n">walletId</span> <span class="o">=</span> <span class="s">"{wallet-id}"</span><span class="o">;</span>

    <span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.testwyre.com/v2/wallet/"</span><span class="o">+</span> <span class="n">walletId</span> <span class="o">+</span><span class="s">"/update"</span><span class="o">;</span>
    <span class="n">String</span> <span class="n">method</span> <span class="o">=</span> <span class="s">"POST"</span><span class="o">;</span>
    <span class="n">String</span> <span class="n">data</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>

    <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">excuteWyreRequest</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="s">""</span><span class="o">,</span> <span class="n">method</span><span class="o">,</span> <span class="n">apiKey</span><span class="o">,</span> <span class="n">secretKey</span><span class="o">);</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>

    <span class="n">data</span> <span class="o">=</span> <span class="s">"{"</span> <span class="o">+</span>
        <span class="s">"  \"name\":\"{your-unique-identifier}\","</span> <span class="o">+</span>
        <span class="s">"  \"notes\":\"Updated notes about the user\""</span> <span class="o">+</span>
        <span class="s">"}"</span><span class="o">;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">excuteWyreRequest</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="n">data</span><span class="o">,</span> <span class="n">method</span><span class="o">,</span> <span class="n">apiKey</span><span class="o">,</span> <span class="n">secretKey</span><span class="o">);</span>

    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">excuteWyreRequest</span><span class="o">(</span><span class="n">String</span> <span class="n">targetURL</span><span class="o">,</span> <span class="n">String</span> <span class="n">requestBody</span><span class="o">,</span> <span class="n">String</span> <span class="n">method</span><span class="o">,</span> <span class="n">String</span> <span class="n">apiKey</span><span class="o">,</span> <span class="n">String</span> <span class="n">secretKey</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">URL</span> <span class="n">url</span><span class="o">;</span>
    <span class="n">HttpURLConnection</span> <span class="n">connection</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">{</span>

      <span class="n">targetURL</span> <span class="o">+=</span> <span class="o">((</span><span class="n">targetURL</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="s">"?"</span><span class="o">)&gt;</span><span class="mi">0</span><span class="o">)?</span><span class="s">"&amp;"</span><span class="o">:</span><span class="s">"?"</span><span class="o">)</span> <span class="o">+</span> <span class="s">"timestamp="</span> <span class="o">+</span> <span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>

      <span class="c1">//Create connection</span>
      <span class="n">url</span> <span class="o">=</span> <span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="n">targetURL</span><span class="o">);</span>
      <span class="n">connection</span> <span class="o">=</span> <span class="o">(</span><span class="n">HttpURLConnection</span><span class="o">)</span><span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
      <span class="n">connection</span><span class="o">.</span><span class="na">setRequestMethod</span><span class="o">(</span><span class="n">method</span><span class="o">);</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">connection</span><span class="o">.</span><span class="na">getRequestMethod</span><span class="o">());</span>

      <span class="n">connection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">);</span>
      <span class="n">connection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"Content-Length"</span><span class="o">,</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">requestBody</span><span class="o">.</span><span class="na">getBytes</span><span class="o">().</span><span class="na">length</span><span class="o">));</span>

      <span class="c1">//Specify API v2</span>
      <span class="n">connection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"X-Api-Version"</span><span class="o">,</span><span class="s">"2"</span><span class="o">);</span>

      <span class="c1">// Provide API key and signature</span>
      <span class="n">connection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"X-Api-Key"</span><span class="o">,</span> <span class="n">apiKey</span><span class="o">);</span>
      <span class="n">connection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"X-Api-Signature"</span><span class="o">,</span><span class="n">computeSignature</span><span class="o">(</span><span class="n">secretKey</span><span class="o">,</span><span class="n">targetURL</span><span class="o">,</span><span class="n">requestBody</span><span class="o">));</span>

      <span class="c1">//Send request</span>
      <span class="k">if</span><span class="o">(</span><span class="n">method</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"POST"</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">connection</span><span class="o">.</span><span class="na">setDoOutput</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
        <span class="n">connection</span><span class="o">.</span><span class="na">setRequestMethod</span><span class="o">(</span><span class="n">method</span><span class="o">);</span>

        <span class="n">DataOutputStream</span> <span class="n">wr</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DataOutputStream</span><span class="o">(</span>
            <span class="n">connection</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">());</span>

        <span class="n">wr</span><span class="o">.</span><span class="na">writeBytes</span><span class="o">(</span><span class="n">requestBody</span><span class="o">);</span>
        <span class="n">wr</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
        <span class="n">wr</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
      <span class="o">}</span>

      <span class="c1">//Get Response</span>
      <span class="n">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span>
      <span class="n">BufferedReader</span> <span class="n">rd</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">InputStreamReader</span><span class="o">(</span><span class="n">is</span><span class="o">));</span>
      <span class="n">String</span> <span class="n">line</span><span class="o">;</span>
      <span class="n">StringBuffer</span> <span class="n">response</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="o">();</span>
      <span class="k">while</span><span class="o">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">response</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">line</span><span class="o">);</span>
        <span class="n">response</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="sc">'\r'</span><span class="o">);</span>
      <span class="o">}</span>
      <span class="n">rd</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
      <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>

    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>

      <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
      <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>

    <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>

      <span class="k">if</span><span class="o">(</span><span class="n">connection</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">connection</span><span class="o">.</span><span class="na">disconnect</span><span class="o">();</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">computeSignature</span><span class="o">(</span><span class="n">String</span> <span class="n">secretKey</span><span class="o">,</span> <span class="n">String</span> <span class="n">url</span><span class="o">,</span> <span class="n">String</span> <span class="n">reqData</span><span class="o">)</span> <span class="o">{</span>

    <span class="n">String</span> <span class="n">data</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="n">reqData</span><span class="o">;</span>

    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>

    <span class="k">try</span> <span class="o">{</span>
      <span class="n">Mac</span> <span class="n">sha256Hmac</span> <span class="o">=</span> <span class="n">Mac</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"HmacSHA256"</span><span class="o">);</span>
      <span class="n">SecretKeySpec</span> <span class="n">key</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecretKeySpec</span><span class="o">(</span><span class="n">secretKey</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(),</span> <span class="s">"HmacSHA256"</span><span class="o">);</span>
      <span class="n">sha256Hmac</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>

      <span class="kt">byte</span><span class="o">[]</span> <span class="n">macData</span> <span class="o">=</span> <span class="n">sha256Hmac</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>

      <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
      <span class="k">for</span> <span class="o">(</span><span class="kd">final</span> <span class="kt">byte</span> <span class="n">element</span> <span class="o">:</span> <span class="n">macData</span><span class="o">){</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">((</span><span class="n">element</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="o">)</span> <span class="o">+</span> <span class="mh">0x100</span><span class="o">,</span> <span class="mi">16</span><span class="o">).</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
      <span class="o">}</span>
      <span class="k">return</span> <span class="n">result</span><span class="o">;</span>

    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
      <span class="k">return</span> <span class="s">""</span><span class="o">;</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre>
<p>This endpoint updates the information for a accounts child wallet. <br></p>

<p><strong>Definition</strong> <br></p>

<p><code>UPDATE</code> https://api.testwyre.com/v2/wallet/{walletId} <br></p>

<p><strong>Parameters</strong></p>

<table><thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead><tbody>
<tr>
<td>walletId</td>
<td>string</td>
<td>ID of the wallet</td>
<td>yes</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>Updated identifier for the user</td>
<td>no</td>
</tr>
<tr>
<td>callbackUrl</td>
<td>string</td>
<td>Updated callback</td>
<td>no</td>
</tr>
<tr>
<td>notes</td>
<td>string</td>
<td>Updated notes</td>
<td>no</td>
</tr>
</tbody></table>
<h2 id='delete-wallet'>Delete Wallet</h2><pre class="highlight plaintext"><code>
curl -v -XDELETE 'https://api.testwyre.com/v2/wallet/{wallet-id}' \
  -H "X-Api-Key: {api-key}" \
  -H "X-Api-Signature: {signature}"
</code></pre>
<p>This endpoint removes the wallet from your account. Note that the wallet data is retained in our system for compliance purposes. Once an account is deleted the Virtual Bank Account associated with the wallet will be closed and no longer availabel for receiving funds. <br></p>

<p><strong>Definition</strong> <br></p>

<p><code>DELETE</code> https://api.testwyre.com/v2/wallet/{walletId} <br></p>

<p><strong>Parameters</strong></p>

<table><thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead><tbody>
<tr>
<td>walletId</td>
<td>string</td>
<td>ID of the wallet</td>
<td>yes</td>
</tr>
</tbody></table>
<h2 id='list-wallets'>List Wallets</h2>
<p>This endpoint will return all the child wallets you have created. <br></p>

<p><strong>Definition</strong> <BR></p>

<p><code>GET</code> https://api.testwyre.com/v2/wallets <BR></p>

<p><strong>Parameters</strong></p>

<table><thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead><tbody>
<tr>
<td>limit</td>
<td>string</td>
<td>The number of results returned</td>
<td>yes</td>
</tr>
<tr>
<td>offset</td>
<td>string</td>
<td>The number of records to skip</td>
<td>yes</td>
</tr>
</tbody></table>

<p><strong>Result Format</strong></p>

<pre class="center-column">
{
  "data": {
      "owner": "account:XAV3CRAC94P",
      "balances": {},
      "srn": "wallet:WA-XM4L3JMUQGF",
      "createdAt": 1508433396000,
      "callbackUrl": "https://shake.webscript.io/callback",
      "depositAddresses": {
        "BTC": "1Q9TqsVwuZf6bYqtxxjqdataXx81x3Q1h7"
      },
      "totalBalances": {},
      "availableBalances": {},
      "notes": "nope",
      "name": "Person A",
      "id": "WA-XM4L3JMUQGF"
    }
  }
</pre>
<h2 id='callbacks'>Callbacks</h2>
<p>We provide a series of HTTP callbacks that allow you to notify users when funds have been deposited and when they become available.</p>

<p><strong>When callbacks are sent</strong> <br>
Callbacks are sent whenever a transactional event occurs that will affect the wallet&#39;s balance. Examples include:</p>

<ul>
<li>Incoming pending transaction</li>
<li>Pending transaction confirmed</li>
<li>Outgoing transaction
<br></li>
</ul>

<p><strong>Callback Acceptance and Retries</strong> <br>
Your system should respond to the callback request with a 200 response. If we do not receive a valid repsonse our system will continue to attempt to send the request.</p>

<p><strong>Result Format</strong> <br></p>

<pre class="center-column">
{
  "createdAt":1531445525097,
  "id":"TR-F3947W8C2C6",
  "source":"transfer:TF-HP4A42EC6DX",
  "dest":"wallet:WA-CF9RFZ7QU6W",
  "currency":"USD",
  "amount":5005.00,
  "status":"CONFIRMED",
  "confirmedAt":1531445525097,
  "cancelledAt":null,
  "reversedAt":null,
  "message":"Deposit for transfer TF-HP4A42EC6DX",
  "allowOverdraft":true,
  "authorizer":"account:AC-XXXXXXXXX",
  "senderProvidedId":null,
  "reversedBy":null,
  "fees":0,
  "feesDest":null,
  "metadata":{
    "Description":"Pending: Transfer of $5005.00 to wallet:WA-CF9RFZ7QU6W",
    "transferId":"TF-HP4A42EC6DX"},
    "tags":[],
    "sourceFees":null,
    "destFees":null
  }
</pre>

<p>The callback payload will be a JSON representation of the transaction that has caused the callback to trigger.</p>
<h1 id='transfers'>Transfers</h1><h2 id='introduction'>Introduction</h2>
<p>Transfers represent the building blocks of our API. Our Transfer API is an incredibly versatile way of moving funds not only externally but internally as well, whether it&#39;s through internal account management or internal exchanges.  Additionally, you can specify differing source and destination currencies and the funds will automatically exchanged into the appropriate currency in our backend. <br>
Anytime you want to move funds around on the platform you will create a Transfer. The Transfer will go through a number of states as funds are moved to the destination of your choice.<BR></p>
<h2 id='transfers-2'>Transfers</h2>
<p><strong>Definition</strong> <br>
<code>POST</code> https://api.testwyre.com/v2/transfer/<br></p>

<table><thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
<th>required</th>
</tr>
</thead><tbody>
<tr>
<td>source</td>
<td>string</td>
<td>An SRN representing an account that the funds will be retrieved from.</td>
<td>no</td>
</tr>
<tr>
<td>sourceAmount</td>
<td>double</td>
<td>The amount to withdrawal from the source, in units of <code>sourceCurrency</code>. Only include <code>sourceAmount</code> OR <code>destAmount</code>, not both.</td>
<td>yes</td>
</tr>
<tr>
<td>sourceCurrency</td>
<td>string</td>
<td>The currency to withdrawal from the source wallet.</td>
<td>yes</td>
</tr>
<tr>
<td>dest</td>
<td>string</td>
<td>An email address, cellphone number, digital currency address, payment method, wallet to send the digital currency to. Note: cellphone numbers are assumed to be a US number, for international numbers include a &#39;+&#39; and the country code as the prefix.</td>
<td>yes</td>
</tr>
<tr>
<td>destAmount</td>
<td>double</td>
<td>Specifies the total amount of currency to deposit (as defined in depositCurrency). Only include <code>sourceAmount</code> OR <code>destAmount</code>, not both.</td>
<td>yes</td>
</tr>
<tr>
<td>destCurrency</td>
<td>string</td>
<td>The currency to deposit. If not provided, the deposit will be the same as the withdrawal currency (no exchange performed).</td>
<td>yes</td>
</tr>
<tr>
<td>customId</td>
<td>string</td>
<td>An optional tag that must be unique for each transaction if used or transaction will fail.</td>
<td>no</td>
</tr>
<tr>
<td>amountIncludesFees</td>
<td>boolean</td>
<td>Optional- if true, the amount given (source, dest, equiv) will be treated as already including the fees and nothing in addition will be withdrew.</td>
<td>no</td>
</tr>
<tr>
<td>preview</td>
<td>boolean</td>
<td>If true, creates a quote transfer object, but does not execute a real transfer.</td>
<td>no</td>
</tr>
</tbody></table>
<h2 id='create-transfer'>Create Transfer</h2>
<pre class="center-column">
{  
   "source":"account:AC-123123123",
   "sourceCurrency":"USD",
   "sourceAmount":"5",
   "dest":"email:sam@testwyre.com",
   "destCurrency":"CNY",
   "message": ""
}
</pre>

<p>This endpoint creates a new money transfer. <br></p>

<p><strong>Definition</strong> <br>
<code>POST</code> https://api.testwyre.com/v2/transfers <br></p>

<table><thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
<th>required</th>
</tr>
</thead><tbody>
<tr>
<td>source</td>
<td>string</td>
<td>An SRN representing an account that the funds will be retrieved from.</td>
<td>no</td>
</tr>
<tr>
<td>sourceAmount</td>
<td>double</td>
<td>The amount to withdrawal from the source, in units of <code>sourceCurrency</code>. Only include <code>sourceAmount</code> OR <code>destAmount</code>, not both.</td>
<td>yes</td>
</tr>
<tr>
<td>sourceCurrency</td>
<td>string</td>
<td>An ISO 3166-1 alpha-3 currency code that will be deducted from your account.</td>
<td>yes</td>
</tr>
<tr>
<td>dest</td>
<td>string</td>
<td>An email address, cellphone number, digital currency address, payment method, wallet to send the digital currency to. Note: cellphone numbers are assumed to be a US number, for international numbers include a &#39;+&#39; and the country code as the prefix.</td>
<td>yes</td>
</tr>
<tr>
<td>destAmount</td>
<td>double</td>
<td>Specifies the total amount of currency to deposit (as defined in depositCurrency). Only include <code>sourceAmount</code> OR <code>destAmount</code>, not both.</td>
<td>yes</td>
</tr>
<tr>
<td>destCurrency</td>
<td>string</td>
<td>An ISO 3166-1 alpha-3 currency code that matches the dest type. The destCurrency can be the same or different from the sourceCurrency. If they are different an exchange will automatically occur.</td>
<td>yes</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>An optional user visible message to be sent with the transaction.</td>
<td>no</td>
</tr>
<tr>
<td>callbackUrl</td>
<td>string</td>
<td>An optional url that Wyre will POST a status callback to.</td>
<td>no</td>
</tr>
<tr>
<td>autoConfirm</td>
<td>boolean</td>
<td>An optional parameter to automatically confirm the transfer order.</td>
<td>no</td>
</tr>
<tr>
<td>customId</td>
<td>string</td>
<td>An optional tag that must be unique for each transaction if used or transaction will fail.</td>
<td>no</td>
</tr>
<tr>
<td>amountIncludesFees</td>
<td>boolean</td>
<td>Optional- if true, the amount given (source, dest, equiv) will be treated as already including the fees and nothing in addition will be withdrew.</td>
<td>no</td>
</tr>
<tr>
<td>muteMessages</td>
<td>boolean</td>
<td>When true, disables outbound emails/messages to the destination.</td>
<td>no</td>
</tr>
</tbody></table>

<p>Once you&#39;ve created the transfer it will be in an UNCONFIRMED state. You will have 30 seconds to review the transfer and <a href="#confirm-transfer">confirm it</a> before the quote expires. If the quote expires you&#39;ll have to reissue the transfer request and confirm the new transfer. However you can CONFIRM the transfer AUTOMATICALLY by setting <code>autoConfirm</code> to <code>true</code>. <br></p>

<p>When reviewing the transfer the main things you&#39;ll want to check out are the following: <br></p>

<p><code>exchangeRate</code> - The quoted exchange rate for the transfer <br>
<code>totalFees</code> - The total fees will always be represented in the source currency. To convert totalFees to the destination currency, multiply totalFees by the exchange rate. Note that this object includes all Wyre fees and miner fees if applicable.<br>
<code>sourceAmount/destAmount</code> - Depending on the request you made, you&#39;ll want to double check these fields at this stage and make sure that you&#39;re either sending or receiving the amount you expected. Note the values for these fields depend on the <code>amountIncludesFees</code> parameter.</p>

<p><strong>Result Format</strong></p>

<pre class="center-column">
{
    "id": "TF-VWGF3WW6JU4",
    "status": "PENDING",
    "failureReason": null,
    "language": "en",
    "createdAt": 1525196883000,
    "updatedAt": 1525196883000,
    "completedAt": 1525196884000,
    "cancelledAt": null,
    "expiresAt": 1525456083000,
    "owner": "account:AC-PJZEFT7JP6J",
    "source": "service:Fiat Credits",
    "dest": "wallet:WA-AFFGZJJ7X82",
    "sourceCurrency": "USD",
    "sourceAmount": 10,
    "destCurrency": "USD",
    "destAmount": 10,
    "exchangeRate": null,
    "message": null,
    "totalFees": 0,
    "fees": {
        "USD": 0
    },
    "customId": null,
    "reversingSubStatus": null,
    "reversalReason": null,
    "pendingSubStatus": null,
    "destName": "amandawallet",
    "sourceName": "Wyre",
    "blockchainTx": null,
    "statusHistories": [
        {
            "id": "HNUBAMZ4YQQ",
            "createdAt": 1525196884000,
            "statusDetail": "Initiating Transfer",
            "state": "INITIATED",
            "failedState": null
        },
        {
            "id": "V8L2MJNPF6D",
            "createdAt": 1525196884000,
            "statusDetail": "Transfer Pending",
            "state": "PENDING",
            "failedState": null
        }
    ]
}
</pre>
<h2 id='confirm-transfer'>Confirm Transfer</h2>
<p>This endpoint confirms a money transfer. Once you&#39;ve created the transfer and receive a 200 response, you will have 30 seconds to confirm the transfer. Note the <code>transferId</code> after you create the transfer. If you want to automatically confirm the transfer without making an additional API call, set parameter <code>autoConfirm</code> to &quot;true&quot; in your <a href="#create-transfer">Create Transfer</a> request. <br></p>

<p><strong>Definition</strong> <br>
<code>POST</code> https://api.testwyre.com/v2/transfer/transferId:/confirm <br></p>

<table><thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>transferId</td>
<td>string</td>
<td>ID of the transfer to confirm</td>
</tr>
</tbody></table>

<p><strong>Result Format</strong> <br></p>

<pre class="center-column">
{
    "id": "TF-VWGF3WW6JU4",
    "status": "COMPLETED",
    "failureReason": null,
    "language": "en",
    "createdAt": 1525196883000,
    "updatedAt": 1525196883000,
    "completedAt": 1525196884000,
    "cancelledAt": null,
    "expiresAt": 1525456083000,
    "owner": "account:AC-PJZEFT7JP6J",
    "source": "service:Fiat Credits",
    "dest": "wallet:WA-AFFGZJJ7X82",
    "sourceCurrency": "USD",
    "sourceAmount": 10,
    "destCurrency": "USD",
    "destAmount": 10,
    "exchangeRate": null,
    "message": null,
    "totalFees": 0,
    "fees": {
        "USD": 0
    },
    "customId": null,
    "reversingSubStatus": null,
    "reversalReason": null,
    "pendingSubStatus": null,
    "destName": "amandawallet",
    "sourceName": "Wyre",
    "blockchainTx": null,
    "statusHistories": [
        {
            "id": "HNUBAMZ4YQQ",
            "createdAt": 1525196884000,
            "statusDetail": "Initiating Transfer",
            "state": "INITIATED",
            "failedState": null
        },
        {
            "id": "V8L2MJNPF6D",
            "createdAt": 1525196884000,
            "statusDetail": "Transfer Completed",
            "state": "COMPLETED",
            "failedState": null
        }
    ]
}
</pre>
<h2 id='lookup-transfer'>Lookup Transfer</h2>
<p>This endpoint allows you to look up information related to a transfer you already created.</p>

<p><strong>Definition</strong> <br>
<code>GET</code> https://api.testwyre.com/v2/transfer?customId=</p>

<table><thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>customId</td>
<td>string</td>
<td>The custom id you provided when creating the transfer</td>
</tr>
</tbody></table>

<p><strong>Result Format</strong> <br></p>

<pre class="center-column">
{
    "id": "TF-VWGF3WW6JU4",
    "status": "COMPLETED",
    "failureReason": null,
    "language": "en",
    "createdAt": 1525196883000,
    "updatedAt": 1525196883000,
    "completedAt": 1525196884000,
    "cancelledAt": null,
    "expiresAt": 1525456083000,
    "owner": "account:AC-PJZEFT7JP6J",
    "source": "service:Fiat Credits",
    "dest": "wallet:WA-AFFGZJJ7X82",
    "sourceCurrency": "USD",
    "sourceAmount": 10,
    "destCurrency": "USD",
    "destAmount": 10,
    "exchangeRate": null,
    "message": null,
    "totalFees": 0,
    "fees": {
        "USD": 0
    },
    "customId": null,
    "reversingSubStatus": null,
    "reversalReason": null,
    "pendingSubStatus": null,
    "destName": "amandawallet",
    "sourceName": "Wyre",
    "blockchainTx": null,
    "statusHistories": [
        {
            "id": "HNUBAMZ4YQQ",
            "createdAt": 1525196884000,
            "statusDetail": "Initiating Transfer",
            "state": "INITIATED",
            "failedState": null
        },
        {
            "id": "V8L2MJNPF6D",
            "createdAt": 1525196884000,
            "statusDetail": "Transfer Completed",
            "state": "COMPLETED",
            "failedState": null
        }
    ]
}
</pre>
<h2 id='transfer-status'>Transfer Status</h2>
<p><strong>Definition</strong> <br>
<code>GET</code> https://api.testwyre.com/v2/transfer/:transferId</p>

<table><thead>
<tr>
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>transferId</td>
<td>string</td>
<td>Wyre generated transferId</td>
</tr>
</tbody></table>

<p><strong>Result Format</strong> <br></p>

<pre class="center-column">
{
    "id": "TF-VWGF3WW6JU4",
    "status": "COMPLETED",
    "failureReason": null,
    "language": "en",
    "createdAt": 1525196883000,
    "updatedAt": 1525196883000,
    "completedAt": 1525196884000,
    "cancelledAt": null,
    "expiresAt": 1525456083000,
    "owner": "account:AC-PJZEFT7JP6J",
    "source": "service:Fiat Credits",
    "dest": "wallet:WA-AFFGZJJ7X82",
    "sourceCurrency": "USD",
    "sourceAmount": 10,
    "destCurrency": "USD",
    "destAmount": 10,
    "exchangeRate": null,
    "message": null,
    "totalFees": 0,
    "fees": {
        "USD": 0
    },
    "customId": null,
    "reversingSubStatus": null,
    "reversalReason": null,
    "pendingSubStatus": null,
    "destName": "amandawallet",
    "sourceName": "Wyre",
    "blockchainTx": null,
    "statusHistories": [
        {
            "id": "HNUBAMZ4YQQ",
            "createdAt": 1525196884000,
            "statusDetail": "Initiating Transfer",
            "state": "INITIATED",
            "failedState": null
        },
        {
            "id": "V8L2MJNPF6D",
            "createdAt": 1525196884000,
            "statusDetail": "Transfer Completed",
            "state": "COMPLETED",
            "failedState": null
        }
    ]
}
</pre>

<p>Once a Transfer enters the PENDING state we will start moving money to the destination account. At some point the Transfer will either move to a COMPLETED status or a FAILED status asynchronously from any API call.</p>
<h2 id='callbacks-2'>Callbacks</h2>
<p>We provide a series of HTTP callbacks that allow you to notify users when funds have been deposited and when they become available.</p>

<p><strong>When callbacks are sent</strong> <br>
Callbacks are sent whenever a transactional event occurs that will affect the account&#39;s balance. Examples include:</p>

<ul>
<li>Incoming pending transaction</li>
<li>Pending transaction confirmed</li>
<li>Outgoing transaction
<br></li>
</ul>

<p>You may receive two callbacks for a single transaction. This is especially true for transactions on the blockchain. In these cases, you would receive one callback when the transaction is first observed and one callback once the transaction is confirmed.</p>

<p><strong>Callback Acceptance and Retries</strong> <br>
Your system should respond to the callback request with a 200 response. We only attempt to send the request once, but we may introduce automatic retries in the future. We can manually resend callbacks upon request.</p>

<p><strong>Result Format</strong> <br></p>

<pre class="center-column">
{
    "id": "TF-VWGF3WW6JU4",
    "status": "COMPLETED",
    "failureReason": null,
    "language": "en",
    "createdAt": 1525196883000,
    "updatedAt": 1525196883000,
    "completedAt": 1525196884000,
    "cancelledAt": null,
    "expiresAt": 1525456083000,
    "owner": "account:AC-PJZEFT7JP6J",
    "source": "service:Fiat Credits",
    "dest": "wallet:WA-AFFGZJJ7X82",
    "sourceCurrency": "USD",
    "sourceAmount": 10,
    "destCurrency": "USD",
    "destAmount": 10,
    "exchangeRate": null,
    "message": null,
    "totalFees": 0,
    "fees": {
        "USD": 0
    },
    "customId": null,
    "reversingSubStatus": null,
    "reversalReason": null,
    "pendingSubStatus": null,
    "destName": "amandawallet",
    "sourceName": "Wyre",
    "blockchainTx": null,
    "statusHistories": [
        {
            "id": "HNUBAMZ4YQQ",
            "createdAt": 1525196884000,
            "statusDetail": "Initiating Transfer",
            "state": "INITIATED",
            "failedState": null
        },
        {
            "id": "V8L2MJNPF6D",
            "createdAt": 1525196884000,
            "statusDetail": "Transfer Completed",
            "state": "COMPLETED",
            "failedState": null
        }
    ]
}
</pre>

<p>The callback payload will be a JSON representation of the transaction that has caused the callback to trigger.</p>
<h1 id='payment-methods'>Payment Methods</h1><h2 id='create-payment-method'>Create Payment Method</h2><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"paymentMethodType"</span><span class="p">:</span><span class="s2">"INTERNATIONAL_TRANSFER"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INDIVIDUAL"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryAddress"</span><span class="p">:</span><span class="w"> </span><span class="s2">"112 Brannan St"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryAddress2"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="err">//Optional</span><span class="w">
    </span><span class="s2">"beneficiaryCity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"San Francisco"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryState"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CA"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryPostal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"94108"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryPhoneNumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+14102239203"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryDobDay"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryDobMonth"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryDobYear"</span><span class="p">:</span><span class="s2">"1989"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"paymentType"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"LOCAL_BANK_WIRE"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">LOCAL_BANK_WIRE</span><span class="w">
    </span><span class="s2">"firstNameOnAccount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Billy-Bob"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"lastNameOnAccount"</span><span class="p">:</span><span class="s2">"Jones"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"accountNumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0000000000000"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"routingNumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0000000000"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"accountType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CHECKING"</span><span class="p">,</span><span class="w"> </span><span class="err">//CHECKING</span><span class="w"> </span><span class="err">or</span><span class="w"> </span><span class="err">SAVINGS</span><span class="w">
    </span><span class="s2">"chargeablePM"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This is going to be your corporation&#39;s bank information.
We take this as a way to validate that they&#39;re the sender of the payment.
It allows us to know where to expect the payment to be coming from.</p>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"paymentMethodType"</span><span class="p">:</span><span class="s2">"INTERNATIONAL_TRANSFER"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CORPORATE"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryCompanyName"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryAddress"</span><span class="p">:</span><span class="w"> </span><span class="s2">"112 Brannan St"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryAddress2"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="err">//Optional</span><span class="w">
    </span><span class="s2">"beneficiaryCity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"San Francisco"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryState"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CA"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryPostal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"94108"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryLandlineNumber"</span><span class="p">:</span><span class="s2">"+123464542947"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryEmailAddress"</span><span class="p">:</span><span class="s2">"tes@testwyre.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryEinTin"</span><span class="p">:</span><span class="s2">"00000000"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryDobDay"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15"</span><span class="p">,</span><span class="w"> </span><span class="err">//Date</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">Incorporation</span><span class="w">
    </span><span class="s2">"beneficiaryDobMonth"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w"> </span><span class="err">//Date</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">Incorporation</span><span class="w">
    </span><span class="s2">"beneficiaryDobYear"</span><span class="p">:</span><span class="s2">"1989"</span><span class="p">,</span><span class="w"> </span><span class="err">//Date</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">Incorporation</span><span class="w">
    </span><span class="s2">"paymentType"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"LOCAL_BANK_WIRE"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">LOCAL_BANK_WIRE</span><span class="w">
    </span><span class="s2">"accountType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CHECKING"</span><span class="p">,</span><span class="w"> </span><span class="err">//CHECKING</span><span class="w"> </span><span class="err">or</span><span class="w"> </span><span class="err">SAVINGS</span><span class="w">
    </span><span class="s2">"accountNumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0000000000000"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"routingNumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0000000000"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"chargeablePM"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint creates a bank account. <br></p>
<h2 id='lookup-payment-method'>Lookup Payment Method</h2>
<p>This endpoint looks up the bank details associated with a payment method you created.<br></p>

<p><strong>Definition</strong> <br>
<code>GET</code> https://api.testwyre.com/v2/paymentMethod/:paymentMethodId</p>

<p><strong>Result Format</strong></p>

<pre class="center-column">
{
    "id": "TestPaymentMethod",
    "owner": "account:ABCDEFG",
    "createdAt": 1230940800000,
    "name": "TEST PAYMENT METHOD",
    "defaultCurrency": "USD",
    "status": "ACTIVE",
    "statusMessage": null,
    "waitingPrompts": [],
    "linkType": "TEST",
    "supportsDeposit": true,
    "nameOnMethod": null,
    "last4Digits": null,
    "brand": null,
    "expirationDisplay": null,
    "countryCode": null,
    "nickname": null,
    "rejectionMessage": null,
    "disabled": false,
    "supportsPayment": true,
    "chargeableCurrencies": [
        "GBP",
        "MXN",
        "HKD",
        "USD",
        "CNY",
        "BRL",
        "EUR",
    ],
    "depositableCurrencies": [
        "USD"
    ],
    "chargeFeeSchedule": null,
    "depositFeeSchedule": null,
    "minCharge": null,
    "maxCharge": null,
    "minDeposit": null,
    "maxDeposit": null,
    "documents": [],
    "srn": "paymentmethod:TestPaymentMethod"
}
</pre>
<h1 id='country-currency-requirements'>Country/Currency Requirements</h1>
<p>Banks in different countries have a unique set of financial requirements that need to be passed to conduct a successful transfer.</p>
<h2 id='china'>China</h2>
<p>Please note that the minimum amount to transfer CNY is 100 CNY. <br></p>

<p><strong>Definition</strong><br>
<code>POST</code> https://api.testwyre.com/v2/transfers <br><br></p>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"dest"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"paymentMethodType"</span><span class="p">:</span><span class="s2">"INTERNATIONAL_TRANSFER"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CN"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CNY"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INDIVIDUAL"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"paymentType"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"LOCAL_BANK_TRANSFER"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">LOCAL_BANK_TRANSFER</span><span class="w"> </span><span class="err">only</span><span class="w">
    </span><span class="s2">"nameOnAccount"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"accountNumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0000000000000000"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"bankName"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"branchName"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"bankCity"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"bankProvince"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"sourceCurrency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"destCurrency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CNY"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"destAmount"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CNY example"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">optional</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">note</span><span class="w">
  </span><span class="s2">"referenceNumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">optional</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">reference</span><span class="w"> </span><span class="err">number</span><span class="w">
  </span><span class="s2">"autoConfirm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">optional</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">automatically</span><span class="w"> </span><span class="err">confirms</span><span class="w"> </span><span class="err">transfer</span><span class="w">
  </span><span class="s2">"callbackUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">optional</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">location</span><span class="w"> </span><span class="err">where</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">receive</span><span class="w"> </span><span class="err">callbacks</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>Transfer Requirements</strong> <br></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dest</td>
<td>object</td>
</tr>
<tr>
<td>dest.paymentMethodType</td>
<td><code>INTERNATIONAL_TRANSFER</code></td>
</tr>
<tr>
<td>dest.country</td>
<td>CN</td>
</tr>
<tr>
<td>dest.currency</td>
<td>CNY</td>
</tr>
<tr>
<td>dest.beneficiaryType</td>
<td><code>INDIVIDUAL</code> or <code>CORPORATE</code></td>
</tr>
<tr>
<td>dest.paymentType</td>
<td><code>LOCAL_BANK_TRANSFER</code></td>
</tr>
<tr>
<td>dest.nameOnAccount</td>
<td>As it appears on bank account - Chinese characters for Chinese nationals</td>
</tr>
<tr>
<td>dest.accountNumber</td>
<td>Same as bank card number</td>
</tr>
<tr>
<td>dest.bankName</td>
<td>Beneficiary bank name in Chinese characters</td>
</tr>
<tr>
<td>dest.branchName</td>
<td>Beneficiary branch name in Chinese characters</td>
</tr>
<tr>
<td>dest.bankCity</td>
<td>Beneficiary bank city in Chinese characters</td>
</tr>
<tr>
<td>dest.bankProvince</td>
<td>Beneficiary bank province in Chinese characters</td>
</tr>
<tr>
<td>sourceCurrency</td>
<td>Currency to be debited from your account</td>
</tr>
<tr>
<td>destCurrency</td>
<td>Currency to be deposited to the dest. If destCurrency doesn&#39;t match the sourceCurrency an exchange will be performed</td>
</tr>
<tr>
<td>destAmount</td>
<td>Amount to be deposited to the dest - the amount debited from your account will be calculated automatically from the exchange rate/fees.</td>
</tr>
</tbody></table>

<p><strong>INDIVIDUALS</strong><br></p>

<ul>
<li>Payments to individuals take a maximum of 6 hours, 24/7.</li>
<li>Payments over CNY 50,000 will be split into smaller payments to ensure no clearing delays.<br></li>
</ul>

<p><strong>CORPORATES</strong><br></p>

<ul>
<li>Payments to corporates take a maximum of 6 hours, during normal business banking hours (9:00 - 17:00, Monday - Friday).</li>
</ul>

<p><strong>Supported Banks</strong><br></p>

<ul>
<li>The list of supported banks are located <a href="https://support.testwyre.com/sending-money/send-money-to-china/list-of-supported-chinese-banks"</a>.</li>
</ul>
<h2 id='usa'>USA</h2>
<p>USD payouts are initiated from one of our banks that corresponds to the country delivered. Please note that the minimum amount to transfer USD is $5.00.</p>

<p><strong>Definition</strong><br>
<code>POST</code> https://api.testwyre.com/v2/transfers <br> <br></p>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"dest"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"paymentMethodType"</span><span class="p">:</span><span class="s2">"INTERNATIONAL_TRANSFER"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INDIVIDUAL"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryAddress"</span><span class="p">:</span><span class="w"> </span><span class="s2">"112 Brannan St"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryAddress2"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="err">//Optional</span><span class="w">
    </span><span class="s2">"beneficiaryCity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"San Francisco"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryState"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CA"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryPostal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"94108"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryPhoneNumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+14102239203"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryDobDay"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryDobMonth"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"beneficiaryDobYear"</span><span class="p">:</span><span class="s2">"1989"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"paymentType"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"LOCAL_BANK_WIRE"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"firstNameOnAccount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Billy-Bob"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"lastNameOnAccount"</span><span class="p">:</span><span class="s2">"Jones"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"accountNumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0000000000000"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"routingNumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0000000000"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"accountType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CHECKING"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">CHECKING</span><span class="w"> </span><span class="err">or</span><span class="w"> </span><span class="err">SAVINGS</span><span class="w">
    </span><span class="s2">"bankName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bank of America"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"sourceCurrency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BRL"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"destCurrency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"destAmount"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="s2">"USD Personal example"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>US Requirements</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dest</td>
<td>object</td>
</tr>
<tr>
<td>dest.paymentMethodType</td>
<td><code>INTERNATIONAL_TRANSFER</code></td>
</tr>
<tr>
<td>dest.country</td>
<td>US</td>
</tr>
<tr>
<td>dest.currency</td>
<td>USD</td>
</tr>
<tr>
<td>dest.beneficiaryType</td>
<td><code>INDIVIDUAL</code> or <code>CORPORATE</code></td>
</tr>
<tr>
<td>dest.beneficiaryPhoneNumber</td>
<td>Required for Individual</td>
</tr>
<tr>
<td>dest.beneficiaryLandlineNumber</td>
<td>Required for Business</td>
</tr>
<tr>
<td>dest.beneficiaryEinTin</td>
<td>Required for Business</td>
</tr>
<tr>
<td>dest.beneficiaryEmailAddress</td>
<td>Required for Business</td>
</tr>
<tr>
<td>dest.beneficiaryCompanyName</td>
<td>Required for Business</td>
</tr>
<tr>
<td>dest.firstNameOnAccount</td>
<td>Beneficiary&#39;s first name</td>
</tr>
<tr>
<td>dest.lastNameOnAccount</td>
<td>Beneficiary&#39;s last name</td>
</tr>
<tr>
<td>dest.accountNumber</td>
<td>Beneficiary account number</td>
</tr>
<tr>
<td>dest.routingNumber</td>
<td>Beneficiary routing number</td>
</tr>
<tr>
<td>dest.accountType</td>
<td><code>CHECKING</code> or <code>SAVINGS</code></td>
</tr>
<tr>
<td>destAmount</td>
<td>Amount to be deposited to the dest - the amount debited from your account will be calculated automatically from the exchange rate/fees.</td>
</tr>
<tr>
<td>destCurrency</td>
<td>Currency to be deposited to the dest. If destCurrency doesn&#39;t match the sourceCurrency an exchange will be performed</td>
</tr>
<tr>
<td>sourceCurrency</td>
<td>Currency to be debited from your account</td>
</tr>
</tbody></table>

<p><strong>Delivery Times</strong> <br>
Bank cut-off time is 4PM CT<br>
If we receive the payment instruction on the day before 4PM CT, the payment will be sent out that same day.-If we receive the payment instruction after 4PM CT, it will be credited to beneficiary next business day +1.<br></p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="cURL">cURL</a>
                <a href="#" data-language-name="ruby">ruby</a>
                <a href="#" data-language-name="python">python</a>
                <a href="#" data-language-name="java">java</a>
                <a href="#" data-language-name="php">php</a>
                <a href="#" data-language-name="json">json</a>
                <a href="#" data-language-name="csharp">csharp</a>
          </div>
      </div>
    </div>
  </body>
</html>
